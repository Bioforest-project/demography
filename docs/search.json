[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "demography",
    "section": "",
    "text": "Introduction\ndemography is a sub-project of the BioForest project. It aims to analyse tree demographic rates (growth, mortality) in selectively logged forests and their relationship with tree biodiversity and composition, as well as abiotic factors (climate, soil, etc.).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "demography",
    "section": "Usage",
    "text": "Usage\nAll demography analyses rely on the quarto documents (files.qmd) that can be run with R and associated environment defined with renv.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#project",
    "href": "index.html#project",
    "title": "demography",
    "section": "Project",
    "text": "Project\ndemography includes:\n\nAnalyse of the data with associated documentation and figures:\n\nReproducible analyses in files.qmd\nResulting pages in docs/\nDocument structure definition in _quarto.yml\n\nData in data/ with:\n\nAll raw data in raw_data/\nAll derived data in derived_sata/\n\nStan Bayesian models in models/\nStan Bayesian models outputs in chains/\nR scripts with functions in r/\nIntermediary files in outputs/\nFigures in figures/\nR environment definition with renv in renv/ and renv/lock\nR files (.Rbuildignore , .Rdata , .Rprofile , .Rhistory, .lintr)\nGit and GitHub files (.gitignore , .github/)\nProject documentation (README.qmd , README.md , NEWS.md, LICENSE )",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#contribution",
    "href": "index.html#contribution",
    "title": "demography",
    "section": "Contribution",
    "text": "Contribution\nYou can contribute to the project by forking the repository on github and cloning the fork to your machine using several options, including GitHub desktop GUI. Further information on contribution are detailed in the online document: https://bioforest-project.github.io/data_preparation/98_contributing.html.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#help",
    "href": "index.html#help",
    "title": "demography",
    "section": "Help",
    "text": "Help\nPlease preferentially create an issue on GitHub for any questions, bugs or help needed regarding demography: https://github.com/Bioforest-project/demography/issues. However, you can contact us by email through people in the core group (see below).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#core-group",
    "href": "index.html#core-group",
    "title": "demography",
    "section": "Core group",
    "text": "Core group\n\nCamille Piponiot (camille.piponiot-laroche@cirad.fr)\nGéraldine Derroire (geraldine.derroire@cirad.fr)\nIrié Casimir Zo-Bi (casimir.zo@inphb.ci)\nDwinda Putri (dwinda.mariska@gmail.com)\nVincy K Wilson (vincykwilson@gmail.com)\n\nThe whole group consist of participants to the Bioforest project.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "11_observations.html",
    "href": "11_observations.html",
    "title": "Observations",
    "section": "",
    "text": "Data exploration.\n\n\nCode\nmetadata &lt;- read_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?gid=0#gid=0\", col_types = \"c\") %&gt;% # nolint\n  rename_all(tolower) %&gt;%\n  select(site, plot, treatment, year_of_harvest) %&gt;%\n  separate(year_of_harvest, \"year_of_harvest\") %&gt;%\n  mutate(year_of_harvest = as.numeric(year_of_harvest)) %&gt;%\n  rename(harvest_year = year_of_harvest) %&gt;%\n  mutate(treatment = ifelse(\n    treatment %in% c(\"control\", \"Control\", \"Natural_Forest\"),\n    \"control\", \"logged\"\n  )) %&gt;%\n  group_by(site) %&gt;%\n  mutate(harvest_year_min = min(harvest_year, na.rm = TRUE)) %&gt;%\n  mutate(harvest_year = ifelse(site == \"Paracou\", 1986, harvest_year)) %&gt;%\n  mutate(harvest_year_min = ifelse(site == \"Paracou\", 1986, harvest_year_min))\ndata &lt;- read_csv(\"data/raw_data/aggregated_data.csv\") %&gt;%\n  rename_all(tolower) %&gt;%\n  left_join(metadata) %&gt;%\n  filter(!(site %in% c(\"Peteco\", \"Bafog\", \"Tene\",\n                       \"Montagne_Tortue\", \"Manare\"))) %&gt;%\n  filter(!(site == \"Kabo\" & year &lt; 1980)) %&gt;%\n  mutate(rel_year = ifelse(treatment == \"control\",\n    year - harvest_year_min,\n    year - harvest_year\n  )) %&gt;%\n  mutate(sitenum = as.numeric(as.factor(site))) %&gt;%\n  group_by(site) %&gt;%\n  mutate(y = ifelse(variable == \"agb\" & site == \"Kibale\",\n    300, value\n  )) %&gt;%\n  ungroup()\ndata_rec &lt;- data %&gt;%\n  filter(treatment == \"logged\", rel_year &gt; 2) %&gt;%\n  mutate(plotnum_rec = as.numeric(as.factor(paste0(site, \"_\", plot))))\ndata_pre &lt;- data %&gt;%\n  filter(rel_year &lt;= 0) %&gt;%\n  mutate(plotnum_pre = as.numeric(as.factor(paste0(site, \"_\", plot))))\ndata_old &lt;- data %&gt;%\n  filter(treatment == \"control\") %&gt;%\n  mutate(plotnum_old = as.numeric(as.factor(paste0(site, \"_\", plot))))\nwrite_tsv(data, \"data/derived_data/data.tsv\")\nwrite_tsv(data_rec, \"data/derived_data/data_rec.tsv\")\nwrite_tsv(data_pre, \"data/derived_data/data_pre.tsv\")\nwrite_tsv(data_old, \"data/derived_data/data_old.tsv\")\n\n\n\n\nCode\nread_tsv(\"data/derived_data/data.tsv\") %&gt;%\n  ggplot(aes(year, value, group = paste(site, plot))) +\n  geom_line() +\n  theme_bw() +\n  facet_wrap(~variable, scales = \"free_y\") +\n  theme(\n    axis.title = element_blank(),\n    strip.text = element_text(size = 6)\n  )\n\n\n\n\n\nAll attributes trajectories.\n\n\n\n\n\n\nCode\nmake_fig &lt;- function(var) {\n  g &lt;- read_tsv(\"data/derived_data/data.tsv\") %&gt;%\n    filter(variable == var) %&gt;%\n    ggplot(aes(year, value, group = paste(site, plot), col = treatment)) +\n    geom_line() +\n    theme_bw() +\n    xlab(\"\") +\n    ylab(\"\") +\n    facet_wrap(~site, scales = \"free\") +\n    geom_vline(aes(xintercept = harvest_year)) +\n    theme(legend.position = \"bottom\") +\n    ggtitle(var)\n  ggsave(plot = g, filename = paste0(\"figures/obs/\", var, \".png\"))\n}\nunique(read_tsv(\"data/derived_data/data.tsv\")$variable) %&gt;%\n  lapply(make_fig)\n\n\n\n\nCode\nread_tsv(\"data/derived_data/data.tsv\") %&gt;%\n  filter(variable == \"agb\") %&gt;%\n  ggplot(aes(year, value, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(expression(\"AGB [\" ~ Mg ~ ha^{\n    -1\n  } ~ \"]\")) +\n  facet_wrap(~site, scales = \"free\") +\n  geom_vline(aes(xintercept = harvest_year)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nAGB trajectories across sites and treatments."
  },
  {
    "objectID": "21_models.html#ltp",
    "href": "21_models.html#ltp",
    "title": "Models",
    "section": "LTP",
    "text": "LTP\nLong term process only model:\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times LTP \\\\\nLTP = 1 - e^{-\\lambda_p \\times time}\n\\end{align}\n\\]\nThe model we use is derived from the common framework for modelling recovery in disturbed tropical forests (Maurent et al. 2023). The forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\).\n\n\nCode\nltp &lt;- function(time, dist, thetainf, lambda) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  return(theta0 + (thetainf - theta0) * (ltp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  )\n\n\n\n\n\nLTP proj with pars."
  },
  {
    "objectID": "21_models.html#stp",
    "href": "21_models.html#stp",
    "title": "Models",
    "section": "STP",
    "text": "STP\nLong term and short term processes model based on disturbance index \\(dist\\):\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]\nThe model we use is derived from the common framework for modelling recovery in disturbed tropical forests (Maurent et al. 2023). The forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\). But in this second version the recovery trajectory can also accommodate a short term increase of decrease of the attribute at a time \\(\\tau\\) with an intensity \\(\\delta\\).\n\n\nCode\nstp &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_stp = stp(time,\n    dist = 0.5, thetainf = 20, lambda = 0.05,\n    tau = 5, delta = 1\n  )) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp), col = \"grey\") +\n  geom_line(aes(y = y_stp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  annotate(\"text\",\n    x = 6, y = 11.3, label = \"tau\",\n    col = \"#f2e5a9\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 5, y = 17.5, label = \"delta\",\n    col = \"#a7d6ac\", parse = TRUE, size = 5\n  ) +\n  geom_segment(aes(x = 6, y = 13, xend = 6, yend = 22),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 22, xend = 6, yend = 13),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 11, xend = 6, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#f2e5a9\"\n  ) +\n  theme(axis.title = element_blank())\n\n\n\n\n\nSTP proj with pars.\n\n\n\n\n\nChoices (to be developed as text in an appendix):\n\nUsing the log of y and a normal distribution centred on log(mu)\nCauchy hyperdist\nForced dist_p&lt;1\nBounds of theta\nFree tau\nFree delta\n\n⚠️ Hump is mathematically opposed to the sign of dist_p-1.\n\n\n\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire, Diego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K. Amani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to Model Recovery in Disturbed Tropical Forests.” Ecological Modelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418."
  },
  {
    "objectID": "30_trajectories.html",
    "href": "30_trajectories.html",
    "title": "Trajectories",
    "section": "",
    "text": "This section develop trajectories per attributes. Boundaries of each parameter are listed below with the figure summarising the meaning of each parameter on the trajectory.\n\n\nCode\nltp &lt;- function(time, dist, thetainf, lambda) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  return(theta0 + (thetainf - theta0) * (ltp))\n}\nstp &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_stp = stp(time,\n    dist = 0.5, thetainf = 20, lambda = 0.05,\n    tau = 5, delta = 1\n  )) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp), col = \"grey\") +\n  geom_line(aes(y = y_stp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  annotate(\"text\",\n    x = 6, y = 11.3, label = \"tau\",\n    col = \"#f2e5a9\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 5, y = 17.5, label = \"delta\",\n    col = \"#a7d6ac\", parse = TRUE, size = 5\n  ) +\n  geom_segment(aes(x = 6, y = 13, xend = 6, yend = 22),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 22, xend = 6, yend = 13),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 11, xend = 6, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#f2e5a9\"\n  ) +\n  theme(axis.title = element_blank())\n\n\n\n\n\nSTP trajectory with parameters.\n\n\n\n\n\nThe forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\). But in this second version the recovery trajectory can also accommodate a short term increase of decrease of the attribute at a time \\(\\tau\\) with an intensity \\(\\delta\\).\n\n\n\nCode\nbounds &lt;- read_sheet(\"https://docs.google.com/spreadsheets/d/1rZZ_dKebVp1RnxI0ZawaSQws72FhubuPZ8O27DzJtFE/edit?usp=sharing\") # nolint\nwrite_tsv(bounds, \"data/derived_data/bounds.tsv\")\n\n\n\n\nCode\nread_tsv(\"data/derived_data/bounds.tsv\") %&gt;%\n  mutate(\n    mu_thetaInf = paste0(\"[\", mu_thetaInf_min, \" ,\", mu_thetaInf_max, \"]\"),\n    thetaInf = paste0(\"[\", thetaInf_min, \" ,\", thetaInf_max, \"]\"),\n    lambda = paste0(\"[\", lambda_min, \" ,\", lambda_max, \"]\"),\n    dist = paste0(\"[\", dist_min, \" ,\", dist_max, \"]\"),\n    delta = paste0(\"[\", delta_min, \" ,\", delta_max, \"]\"),\n    tau = paste0(\"[\", tau_min, \" ,\", tau_max, \"]\")\n  ) %&gt;%\n  select(attribute, mu_thetaInf, thetaInf, lambda, dist, delta, tau) %&gt;%\n  kable(caption = \"Parameters boundaries per attribute.\")\n\n\n\nParameters boundaries per attribute.\n\n\n\n\n\n\n\n\n\n\n\nattribute\nmu_thetaInf\nthetaInf\nlambda\ndist\ndelta\ntau\n\n\n\n\nnstem\n[100 ,1000]\n[50 ,2000]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nagb\n[100 ,500]\n[50 ,1000]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nWD_cwm_ba\n[0.5 ,1.3]\n[0.5 ,1.3]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nFDiv\n[0 ,1]\n[0 ,1]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\ndiversity_q1_gen\n[10 ,100]\n[10 ,100]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\ngini\n[0 ,2]\n[0 ,2]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nba\n[1 ,100]\n[1 ,100]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nFEve\n[0 ,1]\n[0 ,1]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nSLA_cwm_ba\n[1 ,50]\n[1 ,50]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nN_cwm_ba\n[10 ,50]\n[10 ,50]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nhmax_cwm_ba\n[30 ,60]\n[30 ,60]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\n\n\n\n\n\nCode\nltp &lt;- cmdstan_model(\"models/ltp.stan\")\nstp &lt;- cmdstan_model(\"models/stp.stan\")\nvars &lt;- c(\n  \"nstem\", \"agb\", \"WD_cwm_ba\", \"FDiv\", \"diversity_q1_gen\", \"gini\",\n  \"ba\", \"FEve\", \"SLA_cwm_ba\", \"N_cwm_ba\", \"hmax_cwm_ba\"\n)\nfor (var in vars) {\n  sample_model(var, \"ltp\")\n}\nfor (var in vars) {\n  sample_model(var, \"stp\")\n}"
  },
  {
    "objectID": "31_stem.html#data",
    "href": "31_stem.html#data",
    "title": "Stem",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"nstem\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"Stem [ trees\" ~ ha^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "31_stem.html#ltp",
    "href": "31_stem.html#ltp",
    "title": "Stem",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2276.44 2275.98 19.23 19.27 2246.46 2307.99 1.01      377      449\n mu_dist       0.80    0.80  0.02  0.02    0.76    0.84 1.01      387     1237\n sigma_dist    0.09    0.08  0.01  0.01    0.07    0.11 1.00     1709     2934\n dist_p[1]     0.80    0.80  0.07  0.06    0.68    0.89 1.00     1750     2478\n dist_p[2]     0.88    0.88  0.06  0.07    0.77    0.98 1.00     1528     1219\n dist_p[3]     0.78    0.78  0.05  0.05    0.68    0.86 1.00     1972     2153\n dist_p[4]     0.81    0.81  0.07  0.06    0.70    0.91 1.00     1846     1914\n dist_p[5]     0.78    0.79  0.06  0.05    0.69    0.87 1.00     1927     2098\n dist_p[6]     0.83    0.83  0.05  0.05    0.74    0.92 1.00     1609     1181\n dist_p[7]     0.83    0.83  0.06  0.06    0.72    0.94 1.00     1474     1126\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "31_stem.html#stp",
    "href": "31_stem.html#stp",
    "title": "Stem",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2687.10 2686.58 24.14 23.77 2648.60 2729.21 1.02      418      497\n mu_dist       0.74    0.74  0.02  0.02    0.71    0.78 1.00      981     1911\n sigma_dist    0.10    0.09  0.01  0.01    0.07    0.12 1.00     3786     2853\n dist_p[1]     0.71    0.71  0.05  0.04    0.63    0.79 1.00     3638     2397\n dist_p[2]     0.87    0.87  0.06  0.06    0.78    0.96 1.00     2315     1730\n dist_p[3]     0.73    0.73  0.04  0.04    0.67    0.81 1.00     3353     2691\n dist_p[4]     0.73    0.73  0.05  0.05    0.66    0.81 1.00     3383     2091\n dist_p[5]     0.74    0.74  0.04  0.05    0.67    0.81 1.00     3205     2621\n dist_p[6]     0.81    0.81  0.05  0.05    0.74    0.89 1.00     2414     1666\n dist_p[7]     0.77    0.77  0.05  0.05    0.69    0.85 1.00     3499     2609\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "31_stem.html#comparison",
    "href": "31_stem.html#comparison",
    "title": "Stem",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "32_wd.html#data",
    "href": "32_wd.html#data",
    "title": "WD",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"WD_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"WD [ g\" ~ cm^{\n  -3\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "32_wd.html#ltp",
    "href": "32_wd.html#ltp",
    "title": "WD",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4899.02 4897.02 46.03 49.18 4830.01 4982.04 1.08       48       55\n mu_dist       0.97    0.97  0.00  0.01    0.96    0.98 1.06       41      155\n sigma_dist    0.03    0.03  0.00  0.00    0.02    0.03 1.08       30       88\n dist_p[1]     1.01    1.01  0.02  0.02    0.98    1.03 1.11       25      110\n dist_p[2]     0.96    0.96  0.01  0.01    0.94    0.98 1.04       73      427\n dist_p[3]     1.01    1.01  0.01  0.01    0.99    1.04 1.04      625      962\n dist_p[4]     0.98    0.98  0.01  0.01    0.96    1.00 1.03      724     1045\n dist_p[5]     0.98    0.98  0.01  0.01    0.96    1.00 1.06      485      516\n dist_p[6]     0.99    0.99  0.02  0.02    0.96    1.02 1.13       19       23\n dist_p[7]     0.99    0.99  0.01  0.01    0.97    1.01 1.02      318     1201\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "32_wd.html#stp",
    "href": "32_wd.html#stp",
    "title": "WD",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4628.25 4651.86 73.13 52.28 4495.27 4711.41 2.09        5       33\n mu_dist       1.02    1.03  0.02  0.01    0.98    1.05 1.74        6       28\n sigma_dist    0.04    0.04  0.01  0.01    0.03    0.05 1.12       22      318\n dist_p[1]     1.06    1.07  0.03  0.03    1.02    1.11 1.28       10       38\n dist_p[2]     0.99    0.99  0.02  0.02    0.96    1.02 1.15       18      144\n dist_p[3]     1.06    1.06  0.02  0.02    1.02    1.09 1.20       14       44\n dist_p[4]     1.04    1.04  0.03  0.02    0.99    1.08 1.36        9       31\n dist_p[5]     1.02    1.02  0.02  0.02    0.98    1.05 1.23       12       54\n dist_p[6]     1.02    1.02  0.02  0.02    0.99    1.05 1.23       12       59\n dist_p[7]     1.04    1.04  0.02  0.02    1.00    1.07 1.31       10       38\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nfit_stp$draws(\"dist_p\") %&gt;%\n  mcmc_intervals() +\n  geom_vline(xintercept = 1)\n\n\n\n\n\ndelta posteriors."
  },
  {
    "objectID": "32_wd.html#comparison",
    "href": "32_wd.html#comparison",
    "title": "WD",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "33_agb.html#data",
    "href": "33_agb.html#data",
    "title": "AGB",
    "section": "Data",
    "text": "Data\n\nWe removed Kibale by setting all its AGB vales to 300.\n\n\n\nCode\nvar &lt;- \"agb\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"AGB [ t\" ~ ha^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "33_agb.html#ltp",
    "href": "33_agb.html#ltp",
    "title": "AGB",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2866.55 2867.34 14.24 14.23 2842.09 2888.85 1.01     1018     1812\n mu_dist       0.57    0.57  0.03  0.02    0.53    0.61 1.00     4130     3578\n sigma_dist    0.13    0.13  0.02  0.02    0.10    0.16 1.00     3511     2928\n dist_p[1]     0.51    0.51  0.03  0.03    0.47    0.56 1.00     4364     2549\n dist_p[2]     0.72    0.72  0.03  0.03    0.67    0.76 1.00     2727     3223\n dist_p[3]     0.70    0.70  0.05  0.05    0.61    0.77 1.00     4814     2070\n dist_p[4]     0.70    0.70  0.06  0.06    0.59    0.79 1.00     5569     3161\n dist_p[5]     0.68    0.68  0.03  0.03    0.64    0.72 1.00     2993     3138\n dist_p[6]     0.83    0.83  0.06  0.05    0.73    0.92 1.00     3788     2603\n dist_p[7]     0.82    0.82  0.05  0.05    0.73    0.91 1.00     4278     2727\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "33_agb.html#stp",
    "href": "33_agb.html#stp",
    "title": "AGB",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2989.33 2994.75 41.42 49.06 2920.45 3048.94 1.58        6      141\n mu_dist       0.62    0.62  0.03  0.03    0.56    0.67 1.09       29      300\n sigma_dist    0.14    0.14  0.02  0.02    0.11    0.18 1.00     3504     2896\n dist_p[1]     0.51    0.51  0.03  0.03    0.47    0.56 1.00     2731     2929\n dist_p[2]     0.66    0.68  0.08  0.07    0.51    0.76 1.05       78      800\n dist_p[3]     0.70    0.70  0.05  0.04    0.62    0.77 1.00     2458     1553\n dist_p[4]     0.67    0.68  0.08  0.06    0.52    0.77 1.02      379      991\n dist_p[5]     0.68    0.68  0.03  0.03    0.64    0.72 1.02      583      718\n dist_p[6]     0.82    0.83  0.05  0.05    0.74    0.91 1.00     2861     2517\n dist_p[7]     0.83    0.83  0.05  0.05    0.74    0.91 1.00     2766     2403\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nfit_stp$summary(\"lambda_p\", \"mean\") %&gt;%\n  mutate(t95 = log(20) / mean) %&gt;%\n  ggplot(aes(t95)) +\n  geom_histogram() +\n  theme_bw() +\n  scale_x_log10()\n\n\n\n\n\n95% recovery time."
  },
  {
    "objectID": "33_agb.html#comparison",
    "href": "33_agb.html#comparison",
    "title": "AGB",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave, and Bruno Hérault. 2017. “Biomass: An r Package for Estimating Above-Ground Biomass and Its Uncertainty in Tropical Forests.” Edited by Sarah Goslee. Methods in Ecology and Evolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  },
  {
    "objectID": "34_fdiv.html#data",
    "href": "34_fdiv.html#data",
    "title": "FDiv",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"FDiv\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"FDiv\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "34_fdiv.html#ltp",
    "href": "34_fdiv.html#ltp",
    "title": "FDiv",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3084.96 3084.08 32.74 31.50 3033.10 3139.53 1.05       98      120\n mu_dist       1.02    1.02  0.01  0.01    1.00    1.05 1.00     1685     1896\n sigma_dist    0.09    0.09  0.01  0.01    0.07    0.12 1.00     2141     2265\n dist_p[1]     1.18    1.18  0.06  0.06    1.09    1.28 1.00      967     1525\n dist_p[2]     1.30    1.31  0.11  0.11    1.10    1.46 1.00      469      664\n dist_p[3]     0.93    0.93  0.05  0.05    0.85    1.00 1.00     1272     1620\n dist_p[4]     0.79    0.79  0.04  0.04    0.73    0.85 1.00     1045     1884\n dist_p[5]     0.91    0.91  0.04  0.04    0.84    0.98 1.00     1037     1362\n dist_p[6]     0.84    0.83  0.04  0.04    0.77    0.91 1.00     1139     1562\n dist_p[7]     0.89    0.89  0.05  0.05    0.80    0.98 1.01      827     1436\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "34_fdiv.html#stp",
    "href": "34_fdiv.html#stp",
    "title": "FDiv",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2915.80 2932.98 65.05 49.30 2797.96 3001.17 2.18        5       45\n mu_dist       1.00    1.01  0.05  0.05    0.93    1.08 1.67        6       47\n sigma_dist    0.14    0.14  0.02  0.02    0.11    0.18 1.04       58     2387\n dist_p[1]     1.24    1.32  0.23  0.13    0.84    1.47 1.56        6       29\n dist_p[2]     1.35    1.36  0.09  0.10    1.19    1.48 1.19       15      142\n dist_p[3]     0.87    0.87  0.05  0.05    0.79    0.96 1.06       43     2283\n dist_p[4]     0.78    0.65  0.26  0.06    0.56    1.23 1.53        7       28\n dist_p[5]     0.84    0.84  0.06  0.05    0.75    0.92 1.03     2661     1734\n dist_p[6]     0.77    0.77  0.05  0.04    0.67    0.84 1.04     1809     1205\n dist_p[7]     0.76    0.77  0.09  0.07    0.62    0.88 1.06     1447      955\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "34_fdiv.html#comparison",
    "href": "34_fdiv.html#comparison",
    "title": "FDiv",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David Mouillot. 2010. “Functional Diversity Measures: An Overview of Their Redundancy and Their Ability to Discriminate Community Assembly Rules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x."
  },
  {
    "objectID": "35_div_q1_gen.html#data",
    "href": "35_div_q1_gen.html#data",
    "title": "Genus diversity 1",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"diversity_q1_gen\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"Genus diversity\" ~ q == 1)\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#ltp",
    "href": "35_div_q1_gen.html#ltp",
    "title": "Genus diversity 1",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2485.17 2478.00 40.55 36.48 2430.47 2565.00 1.29       11       50\n mu_dist       1.02    1.02  0.03  0.03    0.97    1.07 1.11       24      198\n sigma_dist    0.14    0.14  0.02  0.02    0.11    0.17 1.03       92     2151\n dist_p[1]     1.07    1.06  0.07  0.07    0.96    1.19 1.01     1197     1839\n dist_p[2]     0.76    0.76  0.06  0.05    0.67    0.85 1.01     1101     2302\n dist_p[3]     1.23    1.22  0.08  0.08    1.10    1.37 1.00     1244     1789\n dist_p[4]     0.82    0.82  0.06  0.06    0.73    0.92 1.01      949     1753\n dist_p[5]     1.07    1.06  0.07  0.06    0.96    1.19 1.00     1230     1820\n dist_p[6]     0.91    0.91  0.06  0.06    0.81    1.01 1.01     1097     1911\n dist_p[7]     0.69    0.69  0.06  0.06    0.58    0.78 1.02      261     1924\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#stp",
    "href": "35_div_q1_gen.html#stp",
    "title": "Genus diversity 1",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2244.92 2188.56 145.21 84.74 2091.78 2512.24 2.27        5       15\n mu_dist       1.02    1.02   0.05  0.05    0.94    1.10 1.45        7       22\n sigma_dist    0.16    0.16   0.02  0.02    0.13    0.21 1.08       33      424\n dist_p[1]     1.12    1.11   0.09  0.09    0.99    1.28 1.00      828     1495\n dist_p[2]     0.75    0.75   0.07  0.07    0.65    0.87 1.01      870     1763\n dist_p[3]     1.28    1.28   0.10  0.10    1.12    1.44 1.01      756      849\n dist_p[4]     0.84    0.84   0.07  0.08    0.73    0.96 1.02      359     1572\n dist_p[5]     1.10    1.10   0.09  0.09    0.96    1.26 1.01      576      522\n dist_p[6]     0.92    0.92   0.08  0.08    0.80    1.05 1.02      291     1565\n dist_p[7]     0.65    0.64   0.07  0.07    0.55    0.77 1.02      685     1823\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#comparison",
    "href": "35_div_q1_gen.html#comparison",
    "title": "Genus diversity 1",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMarcon, Eric, and Bruno Hérault. 2015. “Entropart: AnRPackage to Measure and Partition Diversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08."
  },
  {
    "objectID": "37_gini.html#data",
    "href": "37_gini.html#data",
    "title": "Gini",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"gini\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- \"Gini index\"\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "37_gini.html#ltp",
    "href": "37_gini.html#ltp",
    "title": "Gini",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4092.50 4092.78 15.18 15.20 4067.03 4116.78 1.00      761     1467\n mu_dist       0.89    0.89  0.01  0.01    0.87    0.91 1.00     2179     2691\n sigma_dist    0.06    0.06  0.01  0.01    0.05    0.07 1.00     4066     3141\n dist_p[1]     0.85    0.85  0.03  0.03    0.80    0.89 1.01     1200     2165\n dist_p[2]     0.92    0.92  0.02  0.02    0.88    0.96 1.01     1084     1496\n dist_p[3]     0.95    0.95  0.03  0.03    0.90    1.01 1.01     1370     1851\n dist_p[4]     1.00    1.00  0.04  0.03    0.94    1.06 1.01      986     2057\n dist_p[5]     0.97    0.96  0.05  0.03    0.92    1.06 1.01      775      720\n dist_p[6]     1.02    1.02  0.04  0.04    0.95    1.08 1.01     1110     1747\n dist_p[7]     0.98    0.98  0.04  0.04    0.92    1.04 1.01     1096     1589\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "37_gini.html#stp",
    "href": "37_gini.html#stp",
    "title": "Gini",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3865.99 3799.86 145.76 51.80 3732.05 4158.47 1.84        5       28\n mu_dist       0.91    0.91   0.01  0.01    0.88    0.93 1.24       12       92\n sigma_dist    0.06    0.06   0.01  0.01    0.05    0.08 1.02      766     2416\n dist_p[1]     0.84    0.85   0.03  0.03    0.79    0.90 1.03      143     1610\n dist_p[2]     0.91    0.92   0.03  0.03    0.87    0.96 1.03      126      774\n dist_p[3]     0.95    0.95   0.04  0.04    0.89    1.01 1.00     2284     2900\n dist_p[4]     1.00    1.00   0.04  0.04    0.94    1.07 1.01     1907     2688\n dist_p[5]     0.96    0.95   0.05  0.04    0.87    1.04 1.03      141      287\n dist_p[6]     1.02    1.02   0.04  0.04    0.94    1.09 1.00     1677     1215\n dist_p[7]     0.98    0.98   0.04  0.04    0.91    1.04 1.00     1916     2654\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "37_gini.html#comparison",
    "href": "37_gini.html#comparison",
    "title": "Gini",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "38_ba.html#data",
    "href": "38_ba.html#data",
    "title": "BA",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"BA [\" ~ m^2 ~ m^{\n  -2\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "38_ba.html#ltp",
    "href": "38_ba.html#ltp",
    "title": "BA",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2566.41 2567.12 14.60 14.22 2541.63 2589.55 1.00      823     1714\n mu_dist       0.61    0.61  0.02  0.02    0.57    0.65 1.00     4561     3419\n sigma_dist    0.13    0.13  0.02  0.02    0.10    0.16 1.00     3608     2853\n dist_p[1]     0.55    0.55  0.04  0.04    0.49    0.62 1.00     4112     2555\n dist_p[2]     0.76    0.76  0.04  0.04    0.69    0.83 1.00     2741     2699\n dist_p[3]     0.71    0.71  0.06  0.05    0.62    0.80 1.00     4084     2593\n dist_p[4]     0.69    0.69  0.07  0.07    0.58    0.80 1.00     4992     2997\n dist_p[5]     0.69    0.69  0.04  0.04    0.63    0.75 1.00     2801     2935\n dist_p[6]     0.83    0.83  0.06  0.06    0.73    0.93 1.00     2297     2017\n dist_p[7]     0.78    0.78  0.07  0.07    0.66    0.90 1.00     3119     1523\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "38_ba.html#stp",
    "href": "38_ba.html#stp",
    "title": "BA",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2695.69 2696.08 19.92 19.83 2662.66 2728.17 1.00      734     1428\n mu_dist       0.65    0.65  0.03  0.03    0.60    0.70 1.00     2335     3059\n sigma_dist    0.15    0.14  0.02  0.02    0.12    0.18 1.00     3751     2852\n dist_p[1]     0.55    0.55  0.04  0.04    0.49    0.61 1.00     3364     2838\n dist_p[2]     0.76    0.76  0.04  0.04    0.69    0.82 1.00     2147     2584\n dist_p[3]     0.72    0.72  0.05  0.05    0.65    0.80 1.00     3413     2343\n dist_p[4]     0.71    0.71  0.05  0.05    0.62    0.79 1.00     2925     2458\n dist_p[5]     0.69    0.69  0.03  0.03    0.64    0.75 1.00     2499     2871\n dist_p[6]     0.85    0.85  0.05  0.05    0.76    0.94 1.00     1824     1501\n dist_p[7]     0.79    0.79  0.06  0.06    0.70    0.89 1.00     3103     2276\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "38_ba.html#comparison",
    "href": "38_ba.html#comparison",
    "title": "BA",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "39_feve.html#data",
    "href": "39_feve.html#data",
    "title": "FEve",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"FEve\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- \"FEve\"\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "39_feve.html#ltp",
    "href": "39_feve.html#ltp",
    "title": "FEve",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       1980.96 1979.44 26.37 26.25 1939.73 2027.31 1.01      219      199\n mu_dist       1.03    1.03  0.03  0.03    0.98    1.07 1.00     1147     2243\n sigma_dist    0.13    0.12  0.02  0.02    0.10    0.16 1.00     1033     1834\n dist_p[1]     1.07    1.07  0.09  0.08    0.94    1.22 1.00     1199      691\n dist_p[2]     1.10    1.09  0.09  0.08    0.97    1.27 1.00     1425     1188\n dist_p[3]     1.10    1.10  0.09  0.08    0.97    1.26 1.00     1454     1031\n dist_p[4]     0.46    0.46  0.07  0.07    0.35    0.60 1.00     1538      543\n dist_p[5]     0.77    0.77  0.08  0.08    0.65    0.90 1.00     1479     2495\n dist_p[6]     1.00    1.00  0.07  0.07    0.88    1.12 1.00     1214      791\n dist_p[7]     1.09    1.09  0.09  0.08    0.96    1.24 1.00     1639     1601\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "39_feve.html#stp",
    "href": "39_feve.html#stp",
    "title": "FEve",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       1868.97 1842.22 169.53 200.82 1648.74 2159.71 2.92        4\n mu_dist       0.99    0.99   0.05   0.05    0.91    1.06 1.46        7\n sigma_dist    0.14    0.14   0.03   0.03    0.10    0.19 1.26       11\n dist_p[1]     0.98    0.99   0.12   0.12    0.76    1.16 1.19       14\n dist_p[2]     1.11    1.10   0.11   0.11    0.94    1.33 1.02      771\n dist_p[3]     1.05    1.05   0.11   0.10    0.88    1.23 1.07       36\n dist_p[4]     0.44    0.44   0.08   0.07    0.33    0.57 1.09       29\n dist_p[5]     0.72    0.72   0.09   0.09    0.58    0.87 1.05       62\n dist_p[6]     0.99    0.99   0.10   0.09    0.84    1.15 1.01     1386\n dist_p[7]     1.02    1.02   0.12   0.11    0.82    1.20 1.14       19\n ess_tail\n       21\n       68\n      122\n      160\n     1111\n      280\n       61\n      400\n     1517\n      291\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "39_feve.html#comparison",
    "href": "39_feve.html#comparison",
    "title": "FEve",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "40_sla.html#data",
    "href": "40_sla.html#data",
    "title": "SLA",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"SLA_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"SLA [\" ~ mm^2 ~ mg^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "40_sla.html#ltp",
    "href": "40_sla.html#ltp",
    "title": "SLA",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3957.17 3957.14 14.41 14.55 3933.45 3981.40 1.00      892     1736\n mu_dist       0.96    0.96  0.02  0.02    0.94    0.99 1.00     1131     2237\n sigma_dist    0.08    0.08  0.01  0.01    0.06    0.10 1.00     3794     2618\n dist_p[1]     0.94    0.94  0.03  0.03    0.89    0.98 1.00      785     2078\n dist_p[2]     1.03    1.03  0.06  0.08    0.95    1.13 1.00      684     2392\n dist_p[3]     0.98    0.98  0.03  0.03    0.93    1.03 1.00      753     2253\n dist_p[4]     0.97    0.97  0.03  0.03    0.92    1.01 1.00      763     2462\n dist_p[5]     1.05    1.06  0.03  0.03    1.00    1.11 1.00      829     2333\n dist_p[6]     1.13    1.13  0.03  0.03    1.08    1.18 1.00      828     2785\n dist_p[7]     1.07    1.07  0.03  0.03    1.01    1.12 1.00      818     2312\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "40_sla.html#stp",
    "href": "40_sla.html#stp",
    "title": "SLA",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       3653.58 3665.00 346.53 514.40 3253.69 4054.00 2.23        5\n mu_dist       0.97    0.97   0.03   0.03    0.93    1.02 1.49        7\n sigma_dist    0.08    0.08   0.01   0.01    0.06    0.11 1.15       17\n dist_p[1]     0.93    0.93   0.04   0.03    0.87    0.98 1.08       32\n dist_p[2]     1.01    1.02   0.07   0.07    0.90    1.11 1.37        8\n dist_p[3]     0.97    0.97   0.04   0.04    0.90    1.03 1.11       24\n dist_p[4]     0.95    0.96   0.04   0.03    0.89    1.01 1.09       27\n dist_p[5]     1.04    1.04   0.04   0.04    0.97    1.11 1.13       20\n dist_p[6]     1.12    1.12   0.04   0.04    1.04    1.19 1.10       26\n dist_p[7]     1.05    1.05   0.04   0.04    0.98    1.12 1.13       20\n ess_tail\n       36\n       32\n      140\n       97\n       22\n      161\n      138\n       56\n       58\n       77\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "40_sla.html#comparison",
    "href": "40_sla.html#comparison",
    "title": "SLA",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "41_n.html#data",
    "href": "41_n.html#data",
    "title": "N",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"N_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"N [\" ~ mg ~ g^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "41_n.html#ltp",
    "href": "41_n.html#ltp",
    "title": "N",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4584.07 4582.75 26.22 26.78 4544.55 4629.59 1.01      201      256\n mu_dist       0.99    0.99  0.01  0.01    0.97    1.00 1.00     1417     1839\n sigma_dist    0.05    0.05  0.01  0.01    0.04    0.06 1.00     2407     1802\n dist_p[1]     0.98    0.98  0.02  0.02    0.95    1.01 1.00     1333     2312\n dist_p[2]     1.03    1.03  0.02  0.02    1.00    1.06 1.00     1509     2531\n dist_p[3]     0.97    0.97  0.02  0.02    0.94    1.00 1.00     1552     2117\n dist_p[4]     0.95    0.95  0.02  0.02    0.92    0.98 1.00     1389     2415\n dist_p[5]     1.05    1.05  0.02  0.02    1.01    1.08 1.00     1368     2261\n dist_p[6]     0.97    0.97  0.02  0.02    0.94    1.00 1.00     1367     2135\n dist_p[7]     0.95    0.95  0.02  0.02    0.92    0.98 1.00     1358     2467\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "41_n.html#stp",
    "href": "41_n.html#stp",
    "title": "N",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       4598.98 4576.14 114.99 153.17 4434.54 4780.93 2.35        4\n mu_dist       0.99    0.99   0.01   0.01    0.97    1.02 1.56        6\n sigma_dist    0.05    0.05   0.01   0.01    0.04    0.07 1.13       20\n dist_p[1]     0.99    0.99   0.02   0.02    0.95    1.02 1.10       26\n dist_p[2]     1.03    1.03   0.02   0.02    1.00    1.07 1.07       37\n dist_p[3]     0.97    0.97   0.02   0.02    0.94    1.00 1.09       29\n dist_p[4]     0.95    0.95   0.02   0.02    0.92    0.99 1.09       34\n dist_p[5]     1.05    1.05   0.02   0.02    1.01    1.08 1.08       36\n dist_p[6]     0.97    0.97   0.02   0.02    0.94    1.00 1.09       32\n dist_p[7]     0.95    0.95   0.02   0.02    0.92    0.98 1.08       34\n ess_tail\n       29\n       30\n       95\n      117\n      199\n       94\n      115\n      201\n      146\n      119\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "41_n.html#comparison",
    "href": "41_n.html#comparison",
    "title": "N",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "42_hmax.html#data",
    "href": "42_hmax.html#data",
    "title": "hmax",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"hmax_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"hmax [\" ~ m ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "42_hmax.html#ltp",
    "href": "42_hmax.html#ltp",
    "title": "hmax",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4953.59 4953.66 18.42 18.05 4923.40 4983.63 1.01      403     1105\n mu_dist       0.99    0.99  0.01  0.01    0.98    1.00 1.00     2282     2769\n sigma_dist    0.03    0.03  0.01  0.01    0.02    0.04 1.00     3620     3071\n dist_p[1]     1.02    1.02  0.01  0.01    1.00    1.04 1.00     1930     2284\n dist_p[2]     1.02    1.02  0.01  0.01    1.00    1.05 1.00     2031     2561\n dist_p[3]     0.99    0.99  0.01  0.01    0.97    1.01 1.00     1967     2346\n dist_p[4]     0.96    0.96  0.01  0.01    0.94    0.98 1.00     2320     2637\n dist_p[5]     0.98    0.97  0.01  0.01    0.95    1.00 1.00     2079     2693\n dist_p[6]     1.00    1.00  0.01  0.01    0.98    1.02 1.00     2133     2722\n dist_p[7]     1.00    1.00  0.01  0.01    0.98    1.03 1.00     1963     2090\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "42_hmax.html#stp",
    "href": "42_hmax.html#stp",
    "title": "hmax",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       4822.61 4823.01 128.41 150.68 4632.07 5034.86 2.85        4\n mu_dist       1.00    1.00   0.01   0.01    0.98    1.01 1.28       10\n sigma_dist    0.04    0.04   0.01   0.01    0.03    0.05 1.16       17\n dist_p[1]     1.02    1.02   0.02   0.02    1.00    1.05 1.04       76\n dist_p[2]     1.03    1.03   0.02   0.02    1.00    1.06 1.04       86\n dist_p[3]     0.99    0.99   0.02   0.02    0.97    1.02 1.04      113\n dist_p[4]     0.96    0.96   0.02   0.02    0.93    0.98 1.02      165\n dist_p[5]     0.98    0.98   0.02   0.02    0.95    1.00 1.03      164\n dist_p[6]     1.00    1.00   0.02   0.02    0.98    1.03 1.05       61\n dist_p[7]     1.01    1.01   0.02   0.02    0.98    1.04 1.04       65\n ess_tail\n       16\n       36\n      137\n      668\n     1549\n     2573\n     1156\n     2366\n     1186\n     1800\n\n # showing 10 of 10132 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "42_hmax.html#comparison",
    "href": "42_hmax.html#comparison",
    "title": "hmax",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMolto, Q., B. Hérault, J.-J. Boreux, M. Daullet, A. Rousteau, and V. Rossi. 2014. “Predicting Tree Heights for Biomass Estimates in Tropical Forests  a Test from French Guiana.” Biogeosciences 11 (12): 3121–30. https://doi.org/10.5194/bg-11-3121-2014."
  },
  {
    "objectID": "50_parameters.html#likelihood-convergence",
    "href": "50_parameters.html#likelihood-convergence",
    "title": "Parameters",
    "section": "Likelihood convergence",
    "text": "Likelihood convergence\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lp__\") %&gt;%\n  ggplot(aes(forcats::fct_reorder(attribute, desc(rhat)),\n    rhat,\n    fill = rhat\n  )) +\n  geom_col() +\n  coord_flip() +\n  theme_bw() +\n  scale_fill_viridis_c(expression(hat(R)), trans = \"log\") +\n  theme(axis.title = element_blank())\n\n\n\n\n\nLikelihood convergence per forest attribute."
  },
  {
    "objectID": "50_parameters.html#inter-site",
    "href": "50_parameters.html#inter-site",
    "title": "Parameters",
    "section": "Inter-site",
    "text": "Inter-site\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\", parameter != \"mu_thetaInf\"\n  ) %&gt;%\n  mutate(parameter = recode(parameter,\n    \"mu_delta\" = \"mu[~delta]\",\n    \"mu_dist\" = \"mu[~dist]\",\n    \"mu_lambda\" = \"mu[~lambda]\",\n    \"mu_tau\" = \"mu[~tau]\"\n  )) %&gt;%\n  ggplot(aes(x = attribute, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~parameter, scales = \"free_x\", labeller = label_parsed) +\n  coord_flip() +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(\"\")\n\n\n\n\n\nthetaInf across sites"
  },
  {
    "objectID": "50_parameters.html#site",
    "href": "50_parameters.html#site",
    "title": "Parameters",
    "section": "Site",
    "text": "Site\n\nAsymptotic value \\(\\theta_{inf}\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"thetaInf\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(site, color = continent)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attribute, scales = \"free_x\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(theta[Inf])) +\n  xlab(\"\")\n\n\n\n\n\nthetaInf across sites\n\n\n\n\n\n\nBump time \\(\\tau\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"tau\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(site, color = continent)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attribute) +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(tau)) +\n  xlab(\"\")\n\n\n\n\n\ntau across sites"
  },
  {
    "objectID": "50_parameters.html#plot",
    "href": "50_parameters.html#plot",
    "title": "Parameters",
    "section": "Plot",
    "text": "Plot\n\nDisturbance index \\(dist\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"dist\", attribute == \"agb\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(dist)) +\n  xlab(\"Plot\") +\n  ggtitle(\"AGB\")\n\n\n\n\n\ndist across sites & plots for AGB\n\n\n\n\n\n\nBump intensity \\(\\delta\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"delta\", attribute == \"diversity_q1_gen\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(delta)) +\n  xlab(\"Plot\") +\n  ggtitle(\"diversity_q1_gen\")\n\n\n\n\n\ndelta across sites & plots for AGB\n\n\n\n\n\n\nRecovery time \\(t_{95}\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\", attribute == \"agb\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(dist)) +\n  xlab(\"Plot\") +\n  ggtitle(\"AGB\") +\n  scale_y_log10()\n\n\n\n\n\nt95 across sites & plots for AGB"
  },
  {
    "objectID": "51_group1.html#h1---diversity-time",
    "href": "51_group1.html#h1---diversity-time",
    "title": "Group 1",
    "section": "H1 - Diversity & time",
    "text": "H1 - Diversity & time\n\nH1: tree diversity long-term response increases through time to a maximum value, after which it then declines in late succession\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(level == \"inter\") %&gt;%\n  filter((type == \"diversity\" & parameter %in% c(\"mu_delta\", \"mu_tau\")) |\n           (type == \"structure\" & parameter %in% c(\"mu_dist\"))) %&gt;%\n  mutate_at(\n    c(\"median\", \"sd\", \"q5\", \"q95\"),\n    ~ ifelse(parameter == \"mu_dist\", (1 - .) * 100, .)\n  ) %&gt;%\n  mutate_at(\n    c(\"median\", \"sd\", \"q5\", \"q95\"),\n    ~ ifelse(parameter == \"mu_delta\", . * 100, .)\n  ) %&gt;%\n  mutate(parameter = recode(parameter,\n    \"mu_delta\" = \"mu[~delta]~'['~'%'~']'\",\n    \"mu_dist\" = \"1-mu[~dist]~'['~'%'~']'\",\n    \"mu_tau\" = \"mu[~tau]~'['~year~']'\"\n  )) %&gt;%\n  ggplot(aes(x = attribute, col = attribute, label = attribute)) +\n  geom_text(aes(y = median), nudge_x = .15, size = 3) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~parameter, scales = \"free\", labeller = label_parsed) +\n  coord_flip() +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(\"\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  ) +\n  scale_color_discrete(guide = \"none\") +\n  ggtitle(\"Mean intersite\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(level == \"site\") %&gt;%\n  filter(type == \"diversity\" & parameter == \"tau\") %&gt;%\n  ggplot(aes(x = site, col = continent)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attribute) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(tau ~ \"[ year ]\")) +\n  xlab(\"\") +\n  scale_color_discrete(\"\") +\n  ggtitle(expression(Site ~ tau)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(level == \"plot\") %&gt;%\n  filter(type == \"diversity\" & parameter == \"delta\") %&gt;%\n  ggplot(aes(x = 100 * median, y = site, fill = continent)) +\n  ggridges::geom_density_ridges() +\n  facet_wrap(~attribute) +\n  theme_bw() +\n  xlab(expression(delta ~ \"[ % ]\")) +\n  ylab(\"\") +\n  scale_fill_discrete(\"\") +\n  ggtitle(expression(Plot ~ delta)) +\n  theme(legend.position = \"bottom\") +\n  scale_x_log10()\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    type == \"diversity\",\n    parameter %in% c(\"delta\", \"tau\")\n  ) %&gt;%\n  select(attribute, parameter, site, median) %&gt;%\n  pivot_wider(names_from = parameter, values_from = median) %&gt;%\n  unnest(tau, delta) %&gt;%\n  ggplot(aes(tau, delta * 100, fill = site)) +\n  geom_boxplot(varwidth = FALSE, width = 6) +\n  theme_bw() +\n  scale_y_log10() +\n  ylab(expression(delta ~ \"[ % ]\")) +\n  xlab(expression(tau ~ \"[ year ]\")) +\n  scale_fill_discrete(\"\") +\n  ggtitle(expression(Plot ~ delta ~ \"~\" ~ Site ~ tau)) +\n  facet_wrap(~attribute)"
  },
  {
    "objectID": "51_group1.html#h2---diversity-intensity",
    "href": "51_group1.html#h2---diversity-intensity",
    "title": "Group 1",
    "section": "H2 - Diversity & intensity",
    "text": "H2 - Diversity & intensity\n\nH2: tree diversity also shows a non-linear response to increased intensity of logging: lightly logged forests show a transient increase in tree diversity, but more intensively logged forests show a strong negative effect on diversity\n\n\n\nCode\ndist_p &lt;- read_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"dist\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  rename_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ paste0(., \"_dist_ba\"))\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"delta\", type == \"diversity\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes((1 - median_dist_ba) * 100, median * 100, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  xlab(expression(dist[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(delta ~ \"[ % ]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  ggtitle(expression(Plot ~ delta ~ \"~\" ~ dist[BA])) +\n  ggpubr::stat_cor(aes(group = NA))"
  },
  {
    "objectID": "52_group2.html#q1---recovery-rates",
    "href": "52_group2.html#q1---recovery-rates",
    "title": "Group 2",
    "section": "Q1 - Recovery rates",
    "text": "Q1 - Recovery rates\n\nQ1. How do forest attributes vary in recovery rates in the long-term?\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\", parameter == \"mu_lambda\"\n  ) %&gt;%\n  ggplot(aes(x = attribute, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(mu[~lambda])) +\n  xlab(\"\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\", parameter == \"mu_lambda\"\n  ) %&gt;%\n  mutate_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ log(20) / .) %&gt;%\n  ggplot(aes(x = attribute, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(mu[~t95] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(\"\") +\n  scale_y_log10()"
  },
  {
    "objectID": "52_group2.html#q2---recovery-time-intensity",
    "href": "52_group2.html#q2---recovery-time-intensity",
    "title": "Group 2",
    "section": "Q2 - Recovery time & intensity",
    "text": "Q2 - Recovery time & intensity\n\nQ2. How does recovery time vary with disturbance intensities?\n\n\n\nCode\ndist_p &lt;- read_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"dist\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  rename_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ paste0(., \"_dist_ba\"))\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes((1 - median_dist_ba) * 100, median, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  xlab(expression(dist[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(lambda)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\ndist_p &lt;- read_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"dist\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  rename_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ paste0(., \"_dist_ba\"))\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes((1 - median_dist_ba) * 100, median, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  xlab(expression(dist[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "52_group2.html#q3---recovery-rates-abiotic-and-biotic-factors",
    "href": "52_group2.html#q3---recovery-rates-abiotic-and-biotic-factors",
    "title": "Group 2",
    "section": "Q3 - Recovery rates & abiotic and biotic factors",
    "text": "Q3 - Recovery rates & abiotic and biotic factors\n\nQ3. How do abiotic and biotic factors modify recovery rates?\n\nabiotic factors = soil fertility + climate stress + landscape connectivity\nbiotic factors = biodiversity + Ecological strategy (acquisitive versus conservative) + structural diversity\n\n\\(\\lambda\\) & abiotic\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(cwd, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  scale_x_log10() +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Climate ~ Water ~ Deficit ~ \"[\" ~ mm ~ year^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(tmax, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Maximum ~ Temperature ~ \"[\" ~ \"°\" ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(bdod, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Bulk ~ Density ~ \"[\" ~ kg ~ dm^{\n    -3\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(soc, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Soil ~ organic ~ Carbon ~ \"[\" ~ g ~ kg^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(deforested, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Deforested ~ landscape ~ \"[\" ~ \"%\" ~ \"]\")) +\n  scale_x_log10()\n\n\n\n\n\n\n\n\\(\\lambda\\) & biotic\nAll site variables are the mean values for site \\(s\\) across controls and pre-logging inventories.\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(gini_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  xlab(expression(Gini[s])) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(SLA_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  xlab(expression(SLA ~ \"[\" ~ mm^2 ~ mg^{\n    -1\n  } ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(WD_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  xlab(expression(WD ~ \"[\" ~ g ~ cm^{\n    -3\n  } ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  ggplot(aes(diversity_q1_gen_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(lambda)) +\n  xlab(expression(\"Genus diversity\" ~ q == 1)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\\(t_{95}\\) & abiotic\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(cwd, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_x_log10() +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Climate ~ Water ~ Deficit ~ \"[\" ~ mm ~ year^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(tmax, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Maximum ~ Temperature ~ \"[\" ~ \"°\" ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(bdod, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Bulk ~ Density ~ \"[\" ~ kg ~ dm^{\n    -3\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(soc, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Soil ~ organic ~ Carbon ~ \"[\" ~ g ~ kg^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(deforested, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Deforested ~ landscape ~ \"[\" ~ \"%\" ~ \"]\")) +\n  scale_x_log10()\n\n\n\n\n\n\n\n\\(t_{95}\\) & biotic\nAll site variables are the mean values for site \\(s\\) across controls and pre-logging inventories.\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(gini_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(Gini[s])) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(SLA_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(SLA ~ \"[\" ~ mm^2 ~ mg^{\n    -1\n  } ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(WD_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(WD ~ \"[\" ~ g ~ cm^{\n    -3\n  } ~ \"]\")) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t95\") %&gt;%\n  ggplot(aes(diversity_q1_gen_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[95] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(\"Genus diversity\" ~ q == 1)) +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "91_stp_negative.html",
    "href": "91_stp_negative.html",
    "title": "STP negatives",
    "section": "",
    "text": "Using long term and short term processes model based on initial value \\(\\theta_0\\) we had issue with negatives values of \\(\\mu_{rec}\\) resulting in impossible log-values:\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2\n\\end{align}\n\\]\nNegatives values happen when the trajectory is negative and the difference of \\(\\theta\\) and the bump fall below 0, so when \\(time=\\tau\\):\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1 - e^{-\\lambda_p \\times \\tau_s}+\\delta_p) \\leq 0\\\\\n\\end{align}\n\\]\nEn \\(\\lambda_p=0.5\\) et \\(\\tau_s=30\\) , \\(LTP = 1-e^{-0.5*30} \\approx 1\\), thus:\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1+\\delta_p) \\leq 0\\\\\n\\theta_{\\infty,s} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times \\delta_p \\leq 0\\\\\n\\delta_p \\geq \\frac{-\\theta_{\\infty,s}}  {\\theta_{\\infty,s} - \\theta_{0,p}} ~|~ \\theta_{\\infty,s} - \\theta_{0,p} &lt; 0 \\\\\n\\delta_p \\geq \\frac{-1}  {1 - dist_p} ~|~\\theta_{0,p}=dist_p\\times\\theta_{\\infty,s} \\\\\n\\delta_p \\geq \\frac{1}  {dist_p-1}\n\\end{align}\n\\]\nWe could thus use this inequality to constrain \\(\\delta_p\\) on \\(dist_p\\) knowing that stan now accepts parameters bounds to depend on another parameter. However, this is complicated as it depends on the sign in the division above, \\(dist=1\\) is no possible, and near 1 values results in positive or negative infinite values. Thus we simply bounded \\(dist_p\\) to 1.5 for now (50% gain of attribute post-disturbance).\n\n\nCode\nmodel &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = 1:50) %&gt;%\n  mutate(y = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 0.5\n  )) %&gt;%\n  mutate(y2 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 2\n  )) %&gt;%\n  mutate(y3 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 1\n  )) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y, col = \"dist=2, delta=.5\")) +\n  geom_line(aes(y = y2, col = \"dist=2, delta=2\")) +\n  geom_line(aes(y = y3, col = \"dist=2, delta=1\")) +\n  theme_bw()\n\n\n\n\n\nNegative STR examples with delta-dist link.\n\n\n\n\n\n\nCode\ndata.frame(dist = seq(.5, 2, length.out = 100)) %&gt;%\n  mutate(delta_max = 2 - (1 / (dist - 1))) %&gt;%\n  ggplot(aes(dist, delta_max)) +\n  geom_line() +\n  theme_bw()\n\n\n\n\n\ndelta_max with dist."
  },
  {
    "objectID": "92_model_devs.html#stp-sum",
    "href": "92_model_devs.html#stp-sum",
    "title": "Models devs",
    "section": "STP sum",
    "text": "STP sum\nmodels/stp_sum.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-lognormal",
    "href": "92_model_devs.html#stp-lognormal",
    "title": "Models devs",
    "section": "STP lognormal",
    "text": "STP lognormal\nmodels/stp.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-correlated",
    "href": "92_model_devs.html#stp-correlated",
    "title": "Models devs",
    "section": "STP correlated",
    "text": "STP correlated\nmodels/stp_cor.stan\nImposed variance-covariance matrix on dist_p and delta_p.\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#parrallel",
    "href": "92_model_devs.html#parrallel",
    "title": "Models devs",
    "section": "Parrallel",
    "text": "Parrallel\ndummy_par.stan"
  },
  {
    "objectID": "93_notes.html#section",
    "href": "93_notes.html#section",
    "title": "Notes",
    "section": "29/01/24",
    "text": "29/01/24\nSill to do list:\n\nBefore Thursday:\n\nlog SLA and LA change SLA to LMA\n\nAfter:\n\nthetaInfp\njoint or sequential inference across attributes\nGroup 3 help\nN fixation & dispersal"
  },
  {
    "objectID": "93_notes.html#section-1",
    "href": "93_notes.html#section-1",
    "title": "Notes",
    "section": "24/01/24",
    "text": "24/01/24\nSections are randomly ordered.\n\nData preparation\nSLA and LA should be logged in species functional trait preparation and SLA inverted in LMA. The N fixation and dispersal still needs to be cleaned.\n\n\nModels structure\nWe must use the random effect for control plots by adding thetaInf_p for controls and pre-inventories with only a hyperdistribution on mu_thetaInf and sigma_thetaInf_p (either concatenating or with two likelihoods) and by modifying thetaInfp in the equation (l. 43 & 44 on mu_old and mu_rec).\n\n\nTrajectories\nAdd box plots for prelogging and controls, and plot longer time series from 1 to 60 years with scale transformation for time. The diversity trajectories are not that bad, but may require better data preparation rather than tweaking the model.\n\n\nModel selection\nLOO model selection fails and does not take into account parsimony with the number of parameters. However, the results show that \\(\\lambda\\) is highly correlated between STP and LTP models (e.g. AGB) and the choice may not be necessary or may be made post hoc.\n\n\nDisturbance intensity\n\\(dist_p\\) can represent the intensity of disturbance for attributes where it is well modelled (to be verified with data where possible) to provide information after the HDI on diversity trajectories. Sequential inference problem (uncertainty transmission?) or joint but with influence of diversity trajectory back on \\(dist_p\\). Camille proposes to use a hyperdistribution on \\(dist_p\\), informed with harvested volumes if available.\n\n\nOnline workshop\n3-4 sessions with :\n\nGeneral session on Thursday, a quick introduction to data preparation including environment and species, model development, re-introduction to the model with a quick focus on the constrained disturbance index.\nSubgroup session on Thursday, where subgroups make a first exploration of preliminary parameters for their question of interest with associated covariates.\nGeneral session on Friday where sub-groups present their results.\nOptional subgroup session on Friday if they wish.\n\nWe need to prepare for this:\n\nTrajectory attributes: agb, gini, stem, ba, hill q1 genus index, FDiv, Feve, CWM wd, lma, n, hmax.\nAutomatic rmarkdown pdf report for PIs (no pages yet): agb, gini, stem, ba, hill q1 genus index, FDiv, CWM wd, lma, hmax.\nUpdate Mithila Monday afternoon\nPrepare subgroup data and figures for Wednesday (all parameters with fifth usual quantiles, derived parameter \\(t_{95}\\), associated environmental data with description, maybe some graphs).\n\n\n\nSubgroup 3\nMuch remains to be explored, Sylvain’s offers punctual help on theoretical development in sessions with Géraldine and Camille."
  },
  {
    "objectID": "99_references.html",
    "href": "99_references.html",
    "title": "References",
    "section": "",
    "text": "Marcon, Eric, and Bruno Hérault. 2015.\n“Entropart:\nAnRPackage to Measure and Partition\nDiversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08.\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire,\nDiego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K.\nAmani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to\nModel Recovery in Disturbed Tropical Forests.” Ecological\nModelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418.\n\n\nMolto, Q., B. Hérault, J.-J. Boreux, M. Daullet, A. Rousteau, and V.\nRossi. 2014. “Predicting Tree Heights for Biomass Estimates in\nTropical Forests  a Test from French Guiana.”\nBiogeosciences 11 (12): 3121–30. https://doi.org/10.5194/bg-11-3121-2014.\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David\nMouillot. 2010. “Functional Diversity Measures: An Overview of\nTheir Redundancy and Their Ability to Discriminate Community Assembly\nRules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x.\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave,\nand Bruno Hérault. 2017. “Biomass: An r Package for Estimating\nAbove-Ground Biomass and Its Uncertainty in Tropical\nForests.” Edited by Sarah Goslee. Methods in Ecology and\nEvolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  },
  {
    "objectID": "20_flux_model.html",
    "href": "20_flux_model.html",
    "title": "Demographic fluxes",
    "section": "",
    "text": "Selective logging is a widespread disturbance in tropical forests, often altering forest structure and reducing aboveground biomass (AGB). While many forests recover over time, the mechanisms driving this recovery remain incompletely understood. At the core of forest regeneration are demographic processes—namely, the growth of surviving trees, recruitment of new individuals, and mortality. These processes govern changes in stem abundance and biomass accumulation, yet few studies have explicitly quantified their individual contributions to AGB recovery following logging.\nHere we examine how demographic processes influence the trajectory of AGB and stem abundance recovery in post-logging tropical forests. Our aim is to identify the processes that most strongly influence recovery and how long it takes for productivity and mortality to recover to the level of unlogged forests.",
    "crumbs": [
      "Demographic fluxes"
    ]
  },
  {
    "objectID": "11_general_framework.html",
    "href": "11_general_framework.html",
    "title": "Conceptual framework",
    "section": "",
    "text": "Context and motivation",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "21_productivity.html",
    "href": "21_productivity.html",
    "title": "Productivity",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\n\n\nFor productivity we can use the general recovery model as described in (Maurent2023?).\n\\[prod = \\theta_0 + (\\theta_{\\infty} -\\theta_0)\\cdot LTP + \\theta_{\\infty} \\cdot STP\\]\n\\[LTP = 1 - exp(-\\lambda\\cdot t) \\]\n\\[STP = \\delta \\cdot \\left(\\frac{t}{\\tau} \\cdot exp\\left(1 - \\frac{t}{\\tau}\\right)\\right)^2 \\] Below we show the productivity in four sites that have been remeasured for multiple decades.\n\n\nCode\ndata &lt;- read.csv(\"data/derived_data/aggregated_data.csv\")\n\ncontrol_string &lt;- \"unlogged|to be logged|old-growth|control|natural\"\nsilv_string &lt;- \"treatment|devital|thinning\"\n\nplot_info &lt;-\n  read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  mutate(site = ifelse(site == \"BAFOG\", \"Bafog\", site)) |&gt;\n  mutate(site = ifelse(site == \"Montagne_tortue\", \"Montagne_Tortue\", site)) |&gt;\n  # harmonize treatment information as logging and silvicultural treatments\n  mutate(\n    Treatment = ifelse(Treatment != \"\", Treatment, NA),\n    logging = !grepl(control_string, tolower(Treatment)),\n    silv_treat = grepl(silv_string, tolower(Treatment)),\n    year_log = ifelse(site == \"Paracou\", 1986,\n      Year_of_harvest |&gt; substr(1, 4) |&gt; as.numeric()\n    )\n  ) |&gt;\n  select(site, plot, logging, silv_treat, year_log)\n\n\n\n\nCode\ndata |&gt;\n  merge(plot_info, by.x = c(\"Site\", \"Plot\"), by.y = c(\"site\", \"plot\")) |&gt;\n  subset(variable %in% c(\"ba_growth\", \"ba_recr\")) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Misiones\")) |&gt;\n  pivot_wider(names_from = \"variable\") |&gt;\n  ggplot(aes(Year, ba_recr + ba_growth, ,\n    group = Plot,\n    col = ifelse(logging, \"Logged\", \"Control\")\n  )) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"Productivity [Mg/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Productivity"
    ]
  },
  {
    "objectID": "23_stocks_cst_mortality.html",
    "href": "23_stocks_cst_mortality.html",
    "title": "Stocks - with constant mortality",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\n\n\nHere we define productivity with the general recovery model, and we hypothesize that mortality is a constant:\n\\[ prod(t) = \\theta_0 + (\\theta_{\\infty} -\\theta_0)\\cdot\\left(1 - exp(-\\lambda\\cdot t)\\right) + \\theta_{\\infty} \\cdot \\delta \\left(\\frac{t}{\\tau} \\cdot exp\\left(1 - \\frac{t}{\\tau}\\right)\\right)^2\\]\n\\[ba'(t) = prod(t) - k\\] We need \\(lim_{\\infty}(prod) = lim_{\\infty}(mort)\\) to have a stable asymptotic basal area. We therefore have:\n\\(k = \\theta_{\\infty}\\)\nWe can therefore write :\n\\[ba(t) =  ba(0) + \\int_{t=0}^{\\infty}prod(x) dx - \\theta_{\\infty}\\]\nAfter integrating the productivity equation (see Appendix “Integration of STP” for the integration ), we get the following equation for basal area: \\[ba(t) = ba(0) - \\frac{\\theta_{\\infty} - \\theta_0}{\\lambda}(1-e^{-\\lambda\\cdot t})  + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right)\\right)  \\]\nThe figure below illustrates the resulting stocks and fluxes with parameters set to:\n\n\\(\\tau = 10\\)\n\\(\\lambda = 0.05\\)\n\\(\\delta = 0.2\\)\n\\(\\theta_{\\infty} = 0.5\\)\n\\(\\theta_0 = 0.4\\)\n\\(ba_0 = 10\\)\n\n\n\nCode\nthetainf &lt;- 0.5\ntheta0 &lt;- 0.4\nba0 &lt;- 10\nlambda &lt;- 0.05\n\nltp &lt;- function(x, lambda = 0.05) 1 - exp(-lambda * x)\nstp &lt;- function(time, delta = 0.2, tau = 10) {\n  delta * (time / tau * exp(1 - time / tau))^2\n}\nint_stp &lt;- function(time, delta = 0.2, tau = 10) {\n  delta * exp(2) * tau / 4 - delta * exp((1 - time / tau) * 2) *\n    (time^2 / (2 * tau) + time / 2 + tau / 4)\n}\n\nfacet_labs &lt;- c(\n  \"ba\" = \"Basal area [m2/ha]\",\n  \"prod\" = \"Productivity [m2/ha/yr]\",\n  \"mort\" = \"Mortality [m2/ha/yr]\"\n)\n\ndata.frame(t = seq(0, 100, length.out = 200)) |&gt;\n  mutate(\n    prod = theta0 + (thetainf - theta0) * ltp(t) + thetainf * stp(t),\n    mort = thetainf,\n    ba = ba0 + thetainf * int_stp(t) - (thetainf - theta0) / lambda *\n      (1 - exp(-lambda * t))\n  ) |&gt;\n  pivot_longer(-t) |&gt;\n  ggplot(aes(t, value)) +\n  geom_line() +\n  facet_wrap(~name,\n    scales = \"free\", nrow = 3,\n    labeller = labeller(name = facet_labs),\n    strip.position = \"left\"\n  ) +\n  labs(x = \"Recovery time [yr]\", y = NULL) +\n  theme_minimal() +\n  theme(strip.placement = \"outside\")",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Stocks - with constant mortality"
    ]
  },
  {
    "objectID": "92_diff_equa.html",
    "href": "92_diff_equa.html",
    "title": "Differential equation",
    "section": "",
    "text": "We want to solve the following differential equation \\(E\\):\n\\[y'(t) = STP(t) - \\alpha\\cdot exp(-\\lambda \\cdot t) + (\\omega_P-\\omega_M) \\cdot y(t)\\]\nwith:\n\\[STP(t) = \\delta\\left(\\frac{t}{\\tau}\\cdot exp(1-\\frac{t}{\\tau})\\right)^2\\]\nThe general solution of differential equation \\(E_0\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = 0\\]\nis \\(y_G = Kexp((\\omega_P-\\omega_M) t)\\)\nA particular solution of differential equation \\(E_1\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = \\alpha\\cdot exp(-\\lambda\\cdot t)\\]\nis\n\\[y_{p1} = -\\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} \\cdot exp(-\\lambda\\cdot t)\\]\nA particular solution of differential equation \\(E_2\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = \\delta \\left(\\frac{t}{\\tau}exp(1-\\frac{t}{\\tau})\\right)^2\\]\nis\n\\[y_{p2} = exp(1-\\frac{t}{\\tau})^2\\frac{2\\delta}{\\tau^2(-2(\\omega_P-\\omega_M)-\\tau)}\\left(t^2 - t\\frac{4}{(-2(\\omega_P-\\omega_M)-\\tau)} + \\frac{8}{(-2(\\omega_P-\\omega_M)-\\tau)^2}\\right)\\]\nThe general solution to differential equation (E) is therefore:\n\\[y(t) = Kexp(-(\\omega_P-\\omega_M) t) -\\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} \\cdot exp(-\\lambda\\cdot t) + exp(1-\\frac{t}{\\tau})^2\\frac{2\\delta}{\\tau^2(-2(\\omega_P-\\omega_M)-\\tau)}\\left(t^2 - t\\frac{4}{(-2(\\omega_P-\\omega_M)-\\tau)} + \\frac{8}{(-2(\\omega_P-\\omega_M)-\\tau)^2}\\right)\\]\n\\[ K = y_0+ \\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} -\\frac{16e^2\\delta}{\\tau^2(2(\\omega_P-\\omega_M)-\\tau)^3}\\]",
    "crumbs": [
      "Appendices",
      "Differential equation"
    ]
  },
  {
    "objectID": "11_general_framework.html#context-and-motivation",
    "href": "11_general_framework.html#context-and-motivation",
    "title": "Conceptual framework",
    "section": "",
    "text": "Selectively logged forests are becoming the majority of tropical forests \\(\\rightarrow\\) Importance of understanding their recovery process;\nDisturbances such as logging have different effects on the demographic rates of species and can therefore change the species composition and biodiversity in the long term;\nDemographic processes can therefore provide insights into forest resilience.",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#research-questions",
    "href": "11_general_framework.html#research-questions",
    "title": "Conceptual framework",
    "section": "Research questions",
    "text": "Research questions\n\nWhat is the contribution of demographic processes (growth, recruitment, mortality) to post-logging changes in biomass, biodiversity and composition?\nWhat is the link between biomass and biodiversity recovery processes?\nHow do abiotic factors shape demographic processes of recovery?",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#general-diagram",
    "href": "11_general_framework.html#general-diagram",
    "title": "Conceptual framework",
    "section": "General diagram",
    "text": "General diagram\n\n\nCode\ngrViz(\"\ndigraph {\n\n  rankdir=LR\n\n  graph [overlap = true, fontsize = 10]\n\n  subgraph cluster_ba{\n    label='Basal area'; fontsize = 14;\n    node [shape = box, fillcolor='coral', style=filled, fontsize=12]\n    ba_stock [label='Stock']\n    ba_in [label='Gain']\n    ba_out [label='Loss']\n  }\n\n  node [shape = box, fillcolor='coral', style=filled]\n  {rank=same\n  cwm [label='Functional\\ncomposition']\n  div [label='Functional\\ndiversity']\n  }\n  node [fillcolor='powderblue']\n  env [label='Environmental\\nvariables']\n  intensity [label='Logging\\nintensity']\n\n  node [shape = ellipse, fillcolor='whitesmoke']\n  {rank=same\n  closure[label='Canopy\\nclosure']\n  vmax[label='Equilibrium\\nturnover\\nrate']\n  }\n\n  intensity -&gt; closure\n  closure -&gt; {ba_in cwm}\n  vmax -&gt; {ba_out ba_in}\n  env -&gt; {cwm div vmax}\n  cwm -&gt; {ba_in ba_out div}\n  ba_stock -&gt; closure\n\n  edge [style = bold]\n  div -&gt; ba_in\n\n  edge [style = dashed]\n  ba_in -&gt; ba_stock\n  ba_out -&gt; ba_stock\n}\n\")",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "24_stocks_prop_mortality.html",
    "href": "24_stocks_prop_mortality.html",
    "title": "Stocks - with proportional mortality",
    "section": "",
    "text": "Here we define productivity with the general recovery model, and we hypothesize that mortality is proportional to basal area:\n\\[ prod(t) = \\theta_0 + (\\theta_{\\infty} -\\theta_0)\\cdot\\left(1 - exp(-\\lambda\\cdot t) \\right) + \\theta_{\\infty}\\cdot\\delta \\left(\\frac{t}{\\tau} \\cdot exp\\left(1 - \\frac{t}{\\tau}\\right)\\right)^2\\]\n\\[ba'(t) = prod(t) - \\omega \\cdot ba(t)\\] and the initial condition:\n\\[ba(t=0) = BA_0\\]\nThe solution to this equation is:\n\\[ba(t) = \\frac{\\theta_{\\infty}}{\\omega} + Kexp(-\\omega t) + \\frac{\\lambda(\\theta_{\\infty}-\\theta_0) }{1-\\omega\\lambda} \\cdot exp(-\\lambda\\cdot t) + exp(1-\\frac{t}{\\tau})^2\\frac{2\\delta\\theta_{\\infty}}{\\tau^2(2\\omega-\\tau)}\\left(t^2 - t\\frac{4}{(2\\omega-\\tau)} + \\frac{8}{(2\\omega-\\tau)^2}\\right)\\]\nwith:\n\\[ K = ba_0 - \\frac{\\theta_{\\infty}}{\\omega} - \\frac{\\lambda(\\theta_{\\infty}-\\theta_0) }{1-\\omega\\lambda} -\\frac{16e^2\\delta\\theta_{\\infty}}{\\tau^2(2\\omega-\\tau)^3}\\] (see Appendix “Differential equation”)\nBelow is a graph of the resulting fluxes and stocks with parameter values:\n\n\\(\\tau = 10\\)\n\\(\\lambda = 0.05\\)\n\\(\\delta = 0.2\\)\n\\(\\theta_{\\infty} = 0.5\\)\n\\(\\theta_0 = 0.4\\)\n\\(\\omega = 0.02\\)\n\\(ba_0 = 10\\)\n\n\n\nCode\nfacet_labs &lt;- c(\n  \"ba\" = \"Basal area [m2/ha]\",\n  \"prod\" = \"Productivity [m2/ha/yr]\",\n  \"mort\" = \"Mortality [m2/ha/yr]\"\n)\n\ndata.frame(t = seq(0, 200, 1e-2)) |&gt;\n  mutate(\n    ba = int_stocks(t, tau = 5),\n    prod = productivity(t, tau = 5),\n    mort = mortality(t, tau = 5)\n  ) |&gt;\n  pivot_longer(-t) |&gt;\n  ggplot(aes(t, value)) +\n  geom_line() +\n  scale_x_sqrt() +\n  facet_wrap(~name,\n    scales = \"free\", nrow = 3,\n    labeller = labeller(name = facet_labs),\n    strip.position = \"left\"\n  ) +\n  labs(x = \"Recovery time [yr]\", y = NULL) +\n  theme_minimal() +\n  theme(strip.placement = \"outside\")\n\n\n\n\n\n\n\n\n\nTo identify which parameters of the model have the strongest effect on the recovery rate of the basal area, we performed a sensitivity analysis by making each parameter vary while others remained constant, and estimated the time (in years) to recover 95% of basal area lost, estimated as the asymptotic basal area (equal to \\(\\frac{\\theta_{\\infty}}{\\omega}\\)) minus the post-logging basal area \\(BA_0\\).\n\n\nCode\n# what parameters have the most effect on the recovery rate of ba?\npars &lt;- data.frame(\n  param = c(\n    \"tau\", \"lambda\", \"delta\", \"theta[infinity]\",\n    \"theta[0]\", \"omega\", \"ba[0]\"\n  ),\n  min = c(1, 1e-3, 1e-3, 0.1, 0.1, 0.001, 1e-3),\n  max = c(50, 1, 10, 1, 1, 0.2, 20)\n)\n\nget_t95 &lt;- function(tau, lambda, delta, thetainf, theta0, omega, ba0) {\n  min(which(\n    int_stocks(1:1e4, tau, lambda, delta, thetainf, theta0, omega, ba0) &gt; 0.95 *\n      (thetainf / omega - ba0) + ba0\n  ))\n}\npars |&gt;\n  group_by(param) |&gt;\n  reframe(value = exp(seq(log(min), log(max), length.out = 10))) |&gt;\n  cbind(data.frame(\n    tau = 10, lambda = 0.05, delta = 0.2, thetainf = 0.5,\n    theta0 = 0.4, omega = 0.02, ba0 = 10\n  )) |&gt;\n  mutate(\n    tau = ifelse(param == \"tau\", value, tau), ,\n    lambda = ifelse(param == \"lambda\", value, lambda),\n    delta = ifelse(param == \"delta\", value, delta),\n    thetainf = ifelse(param == \"theta[infinity]\", value, thetainf),\n    theta0 = ifelse(param == \"theta[0]\", value, theta0),\n    omega = ifelse(param == \"omega\", value, omega),\n    ba0 = ifelse(param == \"ba[0]\", value, ba0)\n  ) |&gt;\n  # constraints: theta0 &lt; thetainf and ba0 &lt; bainf = thetainf/omega\n  subset(theta0 &lt; thetainf & ba0 &lt; thetainf / omega) |&gt;\n  rowwise() |&gt;\n  mutate(t95 = get_t95(tau, lambda, delta, thetainf, theta0, omega, ba0)) |&gt;\n  ggplot(aes(value, t95)) +\n  geom_line() +\n  scale_x_log10() +\n  scale_y_log10() +\n  facet_wrap(~param,\n    scales = \"free\",\n    labeller = label_parsed,\n    strip.position = \"bottom\"\n  ) +\n  labs(x = NULL, y = \"t95 [yr]\") +\n  theme_minimal() +\n  theme(strip.placement = \"outside\")",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Stocks - with proportional mortality"
    ]
  },
  {
    "objectID": "22_mortality.html",
    "href": "22_mortality.html",
    "title": "Mortality",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\n\n\nDue to its high stochasticity, it is challenging to identify any general trend in mortality. To avoid overcomplicating the model, two simple assumptions can be considered:\n\nthe absolute mortality remains constant over time;\nthe mortality rate (mortality/stocks) remains constant over time.\n\nThe second hypothesis has the advantage of being more robust to limit conditions (e.g. when the stocks tend towards zero, the absolute mortality cannot be higher than the stocks).\n\n\nCode\ndata &lt;- read.csv(\"data/derived_data/aggregated_data.csv\")\n\ncontrol_string &lt;- \"unlogged|to be logged|old-growth|control|natural\"\nsilv_string &lt;- \"treatment|devital|thinning\"\n\nplot_info &lt;-\n  read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  mutate(site = ifelse(site == \"BAFOG\", \"Bafog\", site)) |&gt;\n  mutate(site = ifelse(site == \"Montagne_tortue\", \"Montagne_Tortue\", site)) |&gt;\n  # harmonize treatment information as logging and silvicultural treatments\n  mutate(\n    Treatment = ifelse(Treatment != \"\", Treatment, NA),\n    logging = !grepl(control_string, tolower(Treatment)),\n    silv_treat = grepl(silv_string, tolower(Treatment)),\n    year_log = ifelse(site == \"Paracou\", 1986,\n      Year_of_harvest |&gt; substr(1, 4) |&gt; as.numeric()\n    )\n  ) |&gt;\n  select(site, plot, logging, silv_treat, year_log)\n\n\n\n\nCode\ndata |&gt;\n  merge(plot_info, by.x = c(\"Site\", \"Plot\"), by.y = c(\"site\", \"plot\")) |&gt;\n  subset(variable %in% c(\"ba_mort\", \"ba\")) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Misiones\")) |&gt;\n  subset((Year &gt; year_log + 5 & !is.na(year_log)) | !logging) |&gt;\n  pivot_wider(names_from = \"variable\") |&gt;\n  arrange(Year) |&gt;\n  ggplot(aes(ba, ba_mort)) +\n  geom_point(aes(col = logging, group = Plot)) +\n  geom_path(aes(col = logging, group = Plot)) +\n  geom_smooth() +\n  scale_x_log10() +\n  scale_y_log10() +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\ndata |&gt;\n  merge(plot_info, by.x = c(\"Site\", \"Plot\"), by.y = c(\"site\", \"plot\")) |&gt;\n  subset(variable %in% c(\"ba_mort\", \"ba\")) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Misiones\")) |&gt;\n  subset((Year &gt; year_log + 5 & !is.na(year_log)) | !logging) |&gt;\n  pivot_wider(names_from = \"variable\") |&gt;\n  arrange(Year) |&gt;\n  ggplot(aes(Year, ba_mort / ba)) +\n  geom_point(aes(col = logging, group = Plot)) +\n  geom_path(aes(col = logging, group = Plot)) +\n  labs(y = \"Relative mortality = BAmort/BA\") +\n  # geom_smooth() +\n  scale_x_log10() +\n  scale_y_log10() +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThere doesn’t seem to be a strong correlation between BA mortality and BA in our data, but as a first approximation considering that mortality is proportional to basal area might work.",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Mortality"
    ]
  },
  {
    "objectID": "91_ipp.html",
    "href": "91_ipp.html",
    "title": "Integration of STP",
    "section": "",
    "text": "\\[\\int STP = \\delta \\cdot e^2 \\int \\left(\\left(\\frac{x}{\\tau}\\right)^2 e^{-\\frac{2}{\\tau}x}\\right) dx \\]\nIPP: we use \\(u' = \\frac{2x}{\\tau^2}\\) and \\(v = -\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}\\)\n\\[\\int STP = \\delta \\cdot e^2 \\left( uv - \\int u'v \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( \\left(\\frac{x}{\\tau}\\right)^2\\cdot(-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) - \\int \\frac{2x}{\\tau^2} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x})dx \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\int \\frac{x}{\\tau} e^{-\\frac{2}{\\tau}x}dx \\right) + C\\]\nAgain, we use an IPP with $u’ = $ and \\(v = -\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}\\)\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\left( uv - \\int u'v \\right) \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\left( \\frac{x}{\\tau} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) - \\int \\frac{1}{\\tau} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) \\right) \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}  -\\frac{x}{2} \\cdot e^{-\\frac{2}{\\tau}x} + \\int  \\frac{1}{2} \\cdot e^{-\\frac{2}{\\tau}x}  \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x} -\\frac{x}{2} \\cdot e^{-\\frac{2}{\\tau}x} -\\frac{\\tau}{4} \\cdot e^{-\\frac{2}{\\tau}x} \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^{(1-\\frac{x}{\\tau})2} \\left( -\\frac{x^2}{2\\tau}    -\\frac{x}{2}  -\\frac{\\tau}{4}\\right) + C\\]\n\\[\\int_0^t STP = \\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\]\n\\[\\int_0^t LTP = t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\]\n\\[\\int_0^t prod = \\theta_0\\cdot t + (\\theta_{\\infty} - \\theta_0)\\left(t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\right) + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\right) \\]\nif \\(mort = \\theta_{\\infty}\\):\n\\[\\int_0^t mort = \\theta_{\\infty}\\cdot t\\] then:\n\\[BA(t) = BA(0) + \\theta_0\\cdot t + (\\theta_{\\infty} - \\theta_0)\\left(t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\right) + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\right)  - \\theta_{\\infty}\\cdot t\\]\n\\[BA(t) = BA(0) - \\frac{\\theta_{\\infty} - \\theta_0}{\\lambda}(1-e^{-\\lambda\\cdot t})  + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right)\\right)  \\]",
    "crumbs": [
      "Appendices",
      "Integration of STP"
    ]
  },
  {
    "objectID": "25_calibrate_flux_model.html",
    "href": "25_calibrate_flux_model.html",
    "title": "Calibrate the model with forest inventory data",
    "section": "",
    "text": "Data\nCode\ncontrol_string &lt;- \"unlogged|to be logged|old-growth|control|natural\"\nsilv_string &lt;- \"treatment|devital|thinning\"\n\nplot_info &lt;-\n  read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  mutate(site = ifelse(site == \"BAFOG\", \"Bafog\", site)) |&gt;\n  mutate(site = ifelse(site == \"Montagne_tortue\", \"Montagne_Tortue\", site)) |&gt;\n  # harmonize treatment information as logging and silvicultural treatments\n  mutate(\n    Treatment = ifelse(Treatment != \"\", Treatment, NA),\n    logging = !grepl(control_string, tolower(Treatment)),\n    silv_treat = grepl(silv_string, tolower(Treatment)),\n    year_log = ifelse(site == \"Paracou\", 1986,\n                      Year_of_harvest |&gt; substr(1, 4) |&gt; as.numeric() # nolint\n    )\n  ) |&gt;\n  select(site, plot, logging, silv_treat, year_log)\n\ndata &lt;- read.csv(\"data/derived_data/aggregated_data.csv\") |&gt;\n  subset(Site %in% c(\n    \"Lesong\", \"Mbaiki\", \"Misiones\", \"Moju\", \"Paracou\",\n    \"Sg Lalang\", \"Ulu Muda\"\n  )) |&gt;\n  subset(variable %in% c(\"ba_mort\", \"ba_growth\", \"ba_recr\", \"ba\")) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  mutate(prod = ba_growth + ba_recr, mort = ba_mort, stocks = ba) |&gt;\n  select(!contains(\"ba\")) |&gt;\n  pivot_longer(cols = c(\"stocks\", \"prod\", \"mort\"), names_to = \"variable\") |&gt;\n  merge(plot_info, by.x = c(\"Site\", \"Plot\"), by.y = c(\"site\", \"plot\")) |&gt;\n  mutate(trec = Year - year_log) |&gt;\n  subset(!logging | !is.na(year_log))",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Calibrate the model with forest inventory data"
    ]
  },
  {
    "objectID": "25_calibrate_flux_model.html#model",
    "href": "25_calibrate_flux_model.html#model",
    "title": "Calibrate the model with forest inventory data",
    "section": "Model",
    "text": "Model\nWe used the following parameter bounds when calibrating the model.\n\n\nCode\nbounds &lt;- data.frame(\n  \"muthetaInf_min\" = 0.01,\n  \"muthetaInf_max\" = 1,\n  \"thetaInf_min\" = 0.01,\n  \"thetaInf_max\" = 5,\n  \"lambda_min\" = 1e-3,\n  \"lambda_max\" = 1,\n  \"dist_min\" = 1e-2,\n  \"dist_max\" = 2,\n  \"delta_min\" = 0,\n  \"delta_max\" = 1,\n  \"tau_min\" = 2,\n  \"tau_max\" = 30,\n  \"omega_min\" = 1e-3,\n  \"omega_max\" = 0.5,\n  \"y0_min\" = 1,\n  \"y0_max\" = 30\n)\nbounds |&gt;\n  pivot_longer(everything(), names_to = \"parameter\") |&gt;\n  separate(parameter, c(\"parameter\", \"bound\")) |&gt;\n  pivot_wider(names_from = bound) |&gt;\n  flextable()\n\n\nparameterminmaxmuthetaInf0.0101.0thetaInf0.0105.0lambda0.0011.0dist0.0102.0delta0.0001.0tau2.00030.0omega0.0010.5y01.00030.0\n\n\n\n\nCode\ndata_rec &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(logging & trec &gt; 3) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort)) |&gt;\n  mutate(plotnum = as.numeric(as.factor(paste(Site, Plot))))\ndata_old &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(!logging | trec &lt; 0) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort))\n\n\n\n\nCode\nind_rec &lt;- data_rec |&gt;\n  select(Site, Plot, sitenum, plotnum) |&gt;\n  unique() |&gt;\n  arrange(plotnum)\n\nmdata_control &lt;- list(\n  n = nrow(data_old),\n  s = max(data_rec$sitenum),\n  stocks = data_old$stocks,\n  influx = data_old$prod,\n  outflux = data_old$mort,\n  site = data_old$sitenum,\n  mu_thetaInf_bounds = c(\n    bounds$muthetaInf_min,\n    bounds$muthetaInf_max\n  ),\n  thetaInf_bounds = c(\n    bounds$thetaInf_min,\n    bounds$thetaInf_max\n  ),\n  omega_bounds = c(\n    bounds$omega_min,\n    bounds$omega_max\n  )\n)\n\nsample_model(\"flux_control\", mdata_control)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_control &lt;- as_cmdstan_fit(\n  list.files(\"chains/flux_control/\", full.names = TRUE)\n)\nfit_flux_control\n\n\n       variable    mean  median   sd  mad      q5     q95 rhat ess_bulk\n lp__           1310.07 1310.48 4.09 3.97 1302.66 1316.12 1.01      746\n mu_thetaInf       0.50    0.49 0.07 0.06    0.40    0.62 1.00     2511\n sigma_thetaInf    0.12    0.10 0.08 0.05    0.04    0.26 1.00     1548\n thetaInf_s[1]     0.45    0.45 0.01 0.01    0.43    0.46 1.00     2356\n thetaInf_s[2]     0.63    0.63 0.01 0.01    0.62    0.65 1.00     2930\n thetaInf_s[3]     0.46    0.46 0.01 0.01    0.44    0.48 1.00     2675\n thetaInf_s[4]     0.60    0.50 0.44 0.15    0.21    1.25 1.00     1774\n thetaInf_s[5]     0.35    0.35 0.00 0.00    0.34    0.35 1.00     2690\n thetaInf_s[6]     0.65    0.65 0.02 0.02    0.62    0.68 1.00     2013\n thetaInf_s[7]     0.49    0.49 0.01 0.01    0.47    0.51 1.00     2521\n ess_tail\n     1403\n     1715\n     2144\n     2079\n     2393\n     2765\n      881\n     1994\n     2205\n     2582\n\n # showing 10 of 1330 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_control$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\n\n\nCode\nmdata_logged &lt;- list(\n  n = nrow(data_rec),\n  s = max(data_rec$sitenum),\n  p = max(data_rec$plotnum),\n  stocks = data_rec$stocks,\n  influx = data_rec$prod,\n  outflux = data_rec$mort,\n  time = data_rec$trec,\n  site = data_rec$sitenum,\n  plot = data_rec$plotnum,\n  site_plot = ind_rec$sitenum,\n  mu_thetaInf_s = fit_flux_control$summary(c(\"thetaInf_s\"), mean)$mean,\n  sigma_thetaInf = fit_flux_control$summary(c(\"sigma_thetaInf\"), mean)$mean,\n  mu_omega_s = fit_flux_control$summary(c(\"omega_s\"), mean)$mean,\n  sigma_omega = fit_flux_control$summary(c(\"sigma_omega\"), mean)$mean,\n  thetaInf_bounds = c(\n    bounds$thetaInf_min,\n    bounds$thetaInf_max\n  ),\n  lambda_bounds = c(\n    bounds$lambda_min,\n    bounds$lambda_max\n  ),\n  dist_bounds = c(\n    bounds$dist_min,\n    bounds$dist_max\n  ),\n  delta_bounds = c(\n    bounds$delta_min,\n    bounds$delta_max\n  ),\n  tau_bounds = c(\n    bounds$tau_min,\n    bounds$tau_max\n  ),\n  omega_bounds = c(\n    bounds$omega_min,\n    bounds$omega_max\n  ),\n  y0_bounds = c(\n    bounds$y0_min,\n    bounds$y0_max\n  )\n)\n\nsample_model(\"flux_logged\", mdata_logged)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_logged &lt;- as_cmdstan_fit(\n  list.files(\"chains/flux_logged/\", full.names = TRUE)\n)\nfit_flux_logged\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2134.35 2128.72 33.94 27.61 2089.16 2205.40 1.29       10       35\n mu_dist       0.75    0.75  0.07  0.07    0.64    0.85 1.48        7       50\n sigma_dist    0.24    0.23  0.06  0.06    0.16    0.34 1.40        8       35\n dist_p[1]     0.33    0.34  0.09  0.08    0.17    0.46 1.04       78     1510\n dist_p[2]     0.67    0.70  0.17  0.15    0.37    0.91 1.10       27     1027\n dist_p[3]     0.86    0.88  0.18  0.17    0.52    1.12 1.06       48     1117\n dist_p[4]     1.05    1.03  0.16  0.14    0.82    1.35 1.05       68      252\n dist_p[5]     0.95    0.94  0.15  0.14    0.73    1.21 1.03      130      350\n dist_p[6]     0.51    0.52  0.14  0.15    0.25    0.72 1.19       14      169\n dist_p[7]     0.84    0.83  0.13  0.11    0.66    1.09 1.05       62      211\n\n # showing 10 of 2306 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_logged$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\nThe main parameter values are consistent with our expectations.\n\n\nCode\nc(\"mu_delta\", \"mu_lambda\") |&gt;\n  fit_flux_logged$summary()\n\n\n# A tibble: 2 × 10\n  variable    mean median     sd    mad      q5    q95  rhat ess_bulk ess_tail\n  &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 mu_delta  0.548  0.547  0.0630 0.0687 0.445   0.650   1.44     8.03     67.8\n2 mu_lambda 0.0276 0.0289 0.0159 0.0162 0.00384 0.0527  1.63     6.73     40.2\n\n\nCode\nc(\"thetaInf_s\") |&gt;\n  fit_flux_logged$summary()\n\n\n# A tibble: 7 × 10\n  variable       mean median     sd    mad    q5   q95  rhat ess_bulk ess_tail\n  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 thetaInf_s[1] 0.427  0.427 0.0165 0.0168 0.401 0.454  1.06    44.7    1454. \n2 thetaInf_s[2] 0.903  0.903 0.0257 0.0266 0.862 0.945  1.14    20.2     215. \n3 thetaInf_s[3] 0.488  0.493 0.0380 0.0360 0.419 0.544  1.49     7.52     32.6\n4 thetaInf_s[4] 0.720  0.729 0.0522 0.0472 0.618 0.792  1.44     8.23     38.3\n5 thetaInf_s[5] 0.630  0.629 0.0182 0.0186 0.601 0.660  1.05    65.6     983. \n6 thetaInf_s[6] 0.512  0.514 0.0245 0.0236 0.472 0.551  1.05    71.2     599. \n7 thetaInf_s[7] 0.431  0.431 0.0203 0.0208 0.398 0.464  1.07    45.2    1195. \n\n\nCode\nc(\"omega_s\") |&gt;\n  fit_flux_logged$summary()\n\n\n# A tibble: 7 × 10\n  variable     mean median      sd     mad     q5    q95  rhat ess_bulk ess_tail\n  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 omega_s[1] 0.0170 0.0170 9.93e-4 1.00e-3 0.0155 0.0187  1.03     92.2   1534. \n2 omega_s[2] 0.0126 0.0126 6.33e-4 6.31e-4 0.0116 0.0137  1.10     30.3    772. \n3 omega_s[3] 0.0147 0.0147 1.18e-3 1.19e-3 0.0126 0.0165  1.26     11.4     38.9\n4 omega_s[4] 0.0160 0.0161 1.22e-3 1.21e-3 0.0139 0.0180  1.23     12.6     35.4\n5 omega_s[5] 0.0123 0.0123 6.07e-4 6.11e-4 0.0113 0.0133  1.03    140.    1167. \n6 omega_s[6] 0.0196 0.0196 1.21e-3 1.17e-3 0.0177 0.0216  1.02    326.    1038. \n7 omega_s[7] 0.0182 0.0182 1.10e-3 1.10e-3 0.0164 0.0200  1.03    160.    2667. \n\n\nThe goodness of fit is satisfactory.\n\n\nCode\npred_data &lt;- data_rec |&gt;\n  select(-plotnum) |&gt;\n  mutate(\n    stocks = fit_flux_logged$summary(c(\"mu_stocks\"), median)$median,\n    prod = fit_flux_logged$summary(c(\"mu_influx\"), median)$median,\n    mort = fit_flux_logged$summary(c(\"mu_outflux\"), median)$median,\n    val = \"pred\",\n    type = \"rec\"\n  ) |&gt;\n  rbind(mutate(\n    data_old,\n    stocks = fit_flux_control$summary(c(\"mu_stocks\"), median)$median,\n    prod = fit_flux_control$summary(c(\"mu_influx\"), median)$median,\n    mort = fit_flux_control$summary(c(\"mu_outflux\"), median)$median,\n    val = \"pred\",\n    type = \"old\"\n  ))\n\nobs_data &lt;- data_rec |&gt;\n  mutate(\n    val = \"obs\",\n    type = \"rec\"\n  ) |&gt;\n  select(-plotnum) |&gt;\n  rbind(mutate(\n    data_old,\n    val = \"obs\",\n    type = \"old\"\n  ))\n\npov_data &lt;- rbind(pred_data, obs_data) |&gt;\n  pivot_longer(cols = c(stocks, prod, mort), names_to = \"variable\") |&gt;\n  pivot_wider(names_from = val, values_from = value)\n\ndf_rmse &lt;- pov_data |&gt;\n  group_by(variable) |&gt;\n  summarise(rmse = sqrt(mean((pred - obs)^2)))\n\nlabs &lt;- c(stocks = \"BA stocks\", prod = \"BA productivity\", mort = \"BA mortality\")\n\npov_data |&gt;\n  ggplot(aes(pred, obs)) +\n  geom_point(alpha = 0.25, aes(col = type)) +\n  geom_abline(col = \"red\", linetype = \"dashed\") +\n  geom_text(\n    data = df_rmse,\n    aes(\n      x = -Inf, y = Inf, hjust = -0.1, vjust = 1,\n      label = paste(\"RMSE =\", round(rmse, 2))\n    )\n  ) +\n  theme_bw() +\n  xlab(\"Predicted\") +\n  ylab(\"Observed\") +\n  facet_wrap(~variable, scales = \"free\", labeller = labeller(variable = labs))\n\n\n\n\n\nPredicted vs observed values.\n\n\n\n\n\nVisualising the trajectories\nThe predicted flux and stocks trajectories look consistent with the data.\n\n\nCode\nlabs_type &lt;- c(old = \"Old-growth and pre-logging\", rec = \"Logged\")\n\npov_data |&gt;\n  subset(variable == \"stocks\" & Site %in% c(\"Paracou\", \"Mbaiki\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, y = obs)) +\n  geom_point(aes(group = Plot, col = Plot)) +\n  geom_line(aes(group = Plot, col = Plot, y = pred)) +\n  ylab(expression(\"Basal area [\" ~ m^2 ~ ha^-1 ~ \"]\")) +\n  theme_bw() +\n  facet_grid(Site ~ type, scales = \"free\", labeller = labeller(type = labs_type)\n  )\n\n\n\n\n\nPredicted trajectories in Paracou and Mbaiki.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"prod\" & Site %in% c(\"Paracou\", \"Mbaiki\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, y = obs)) +\n  geom_point(aes(group = Plot, col = Plot)) +\n  geom_line(aes(group = Plot, col = Plot, y = pred)) +\n  geom_smooth() +\n  ylab(expression(\"Basal area productivity [\" ~ m^2 ~ ha^-1 ~ yr^-1 ~ \"]\")) +\n  theme_bw() +\n  facet_grid(Site ~ type, scales = \"free\", labeller = labeller(type = labs_type)\n  )\n\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\nPredicted trajectories in Paracou and Mbaiki.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"mort\" & Site %in% c(\"Paracou\", \"Mbaiki\", \"Lesong\")) |&gt;\n  subset(obs &lt; 2.5) |&gt;\n  ggplot(aes(Year, y = obs)) +\n  geom_point(aes(group = Plot, col = Plot)) +\n  geom_line(aes(group = Plot, col = Plot, y = pred)) +\n  geom_smooth() +\n  ylab(expression(\"Basal area mortality [\" ~ m^2 ~ ha^-1 ~ yr^-1 ~ \"]\")) +\n  theme_bw() +\n  facet_grid(Site ~ type, scales = \"free\", labeller = labeller(type = labs_type)\n  )\n\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\nPredicted trajectories in Paracou and Mbaiki.\n\n\n\n\n\n\nNotes\n\nInconsistency between productivity - mortality and change in BA in the observed data\nThere is an inconsistency between annual changes in BA and flux values (especially in Mbaiki) that needs to be resolved in the data aggregation step.\n\n\nCode\nobs_data |&gt;\n  subset(logging & trec &gt; 3) |&gt;\n  arrange(Site, Plot, Year) |&gt;\n  group_by(Site, Plot) |&gt;\n  mutate(\n    diff_stock = c(NA, diff(stocks) / diff(Year)),\n    diff_flux = prod - mort\n  ) |&gt;\n  ggplot(aes(diff_stock, diff_flux)) +\n  geom_abline(lty = 2) +\n  xlab(expression(\"Productivity - mortality [\" ~ m^2 ~ ha^-1 ~ yr^-1 ~ \"]\")) +\n  ylab(expression(\"Changes in BA [\" ~ m^2 ~ ha^-1 ~ yr^-1 ~ \"]\")) +\n  geom_point(alpha = 0.2, aes(col = Site)) +\n  theme_classic()",
    "crumbs": [
      "Integrating fluxes and stocks",
      "Calibrate the model with forest inventory data"
    ]
  },
  {
    "objectID": "21_flux_data.html",
    "href": "21_flux_data.html",
    "title": "Flux data",
    "section": "",
    "text": "Choice of variables\nBelow we show the productivity in four sites that have been remeasured for multiple decades.\nCode\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\")\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\")\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable %in% c(\"agb_growth\", \"agb_recr\")) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  pivot_wider(names_from = \"variable\") |&gt;\n  ggplot(aes(Year, agb_recr + agb_growth, ,\n    group = plot_new,\n    col = Treatment\n  )) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"AGB productivity [Mg/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"nstem_recr\") |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"Stem recruitment [/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"agb_mort\") |&gt;\n  filter(Treatment == \"Control\" | Year &gt;= Year_of_harvest + 3) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"AGB mortality [Mg/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"nstem_mort\") |&gt;\n  filter(Treatment == \"Control\" | Year &gt;= Year_of_harvest + 3) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"Stem mortality [/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Flux data"
    ]
  },
  {
    "objectID": "21_flux_data.html#site-selection",
    "href": "21_flux_data.html#site-selection",
    "title": "Flux data",
    "section": "Site selection",
    "text": "Site selection\nIn this analysis, we only kept sites that meet the following criteria:\n\nat least 4 post-logging measurements\nat least 10 years of post-logging measurements\npresence of control plots\nproductivity values &lt; 10% (too high)?\n\n\n\nCode\ncriteria_site &lt;- data |&gt;\n  inner_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  group_by(Site) |&gt;\n  summarise(\n    controls = length(unique(plot_new[Treatment == \"Control\"])),\n    logged = length(unique(plot_new[Treatment == \"Logging\"]))\n  )\ndata |&gt;\n  inner_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(Treatment == \"Logging\" & !is.na(Year)) |&gt;\n  group_by(Site, plot_new) |&gt;\n  summarise(\n    ncensus = length(unique(Year[Year &gt; Year_of_harvest])),\n    tcensus = max(Year, na.rm = TRUE) - unique(Year_of_harvest)\n  ) |&gt;\n  group_by(Site) |&gt;\n  summarise(ncensus = median(ncensus), tcensus = median(tcensus)) |&gt;\n  left_join(criteria_site) |&gt;\n  filter(ncensus &gt; 3, tcensus &gt; 9, controls &gt; 0, logged &gt; 0) |&gt;\n  write.csv(\"data/derived_data/sites_to_keep.csv\", row.names = FALSE)\n\n\n\n\nCode\nread.csv(\"data/derived_data/sites_to_keep.csv\") |&gt;\n  arrange(-ncensus) |&gt;\n  kable()\n\n\n\n\n\nSite\nncensus\ntcensus\ncontrols\nlogged\n\n\n\n\nMbaiki\n30\n36.0\n12\n28\n\n\nParacou\n22\n35.0\n24\n36\n\n\nLesong\n12\n30.0\n4\n8\n\n\nSUAS\n12\n24.0\n4\n16\n\n\nUlu Muda\n12\n25.0\n3\n6\n\n\nSungai Lalang\n11\n27.0\n3\n6\n\n\nTapajos Km67\n11\n36.0\n18\n48\n\n\nCorinto\n10\n29.0\n3\n6\n\n\nBAFOG\n9\n74.0\n8\n12\n\n\nJenaro Herrera\n8\n28.0\n2\n7\n\n\nJari\n7\n26.0\n4\n36\n\n\nMisiones\n7\n19.5\n4\n14\n\n\nKibale\n6\n52.0\n11\n15\n\n\nSTREK\n6\n33.0\n12\n36\n\n\nKabo\n4\n33.0\n3\n9",
    "crumbs": [
      "Demographic fluxes",
      "Flux data"
    ]
  },
  {
    "objectID": "23_calibrate_flux_model.html",
    "href": "23_calibrate_flux_model.html",
    "title": "Model calibration",
    "section": "",
    "text": "Data\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\n\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"^agb\", variable)) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  mutate(prod = agb_growth + agb_recr, mort = agb_mort, stocks = agb) |&gt;\n  select(!contains(\"agb\")) |&gt;\n  pivot_longer(cols = c(\"stocks\", \"prod\", \"mort\"), names_to = \"variable\") |&gt;\n  mutate(Year_of_harvest = ifelse(Site == \"Mbaiki\" & Treatment == \"Logging\",\n    1985, Year_of_harvest\n  )) |&gt;\n  mutate(trec = Year - Year_of_harvest)\nFor now, we only calibrate the model with sites that meet all the criteria listed here, and that have at least 10 censuses.\nCode\nsites &lt;- read.csv(\"data/derived_data/sites_to_keep.csv\") |&gt;\n  filter(ncensus &gt;= 10)\ndata &lt;- data |&gt;\n  filter(Site %in% sites$Site)",
    "crumbs": [
      "Demographic fluxes",
      "Model calibration"
    ]
  },
  {
    "objectID": "23_calibrate_flux_model.html#model",
    "href": "23_calibrate_flux_model.html#model",
    "title": "Model calibration",
    "section": "Model",
    "text": "Model\nWe used the following parameter bounds when calibrating the model.\n\n\nCode\nbounds &lt;- data.frame(\n  \"theta_min\" = 50,\n  \"theta_max\" = 1000,\n  \"lambda_min\" = 1e-2,\n  \"lambda_max\" = 5,\n  \"alpha_min\" = 0,\n  \"alpha_max\" = 200,\n  \"delta_min\" = 0,\n  \"delta_max\" = 20,\n  \"tau_min\" = 2,\n  \"tau_max\" = 30,\n  \"omega_min\" = 1e-3,\n  \"omega_max\" = 0.5,\n  \"y0_min\" = 10,\n  \"y0_max\" = 1000\n)\nbounds |&gt;\n  pivot_longer(everything(), names_to = \"parameter\") |&gt;\n  separate(parameter, c(\"parameter\", \"bound\")) |&gt;\n  pivot_wider(names_from = bound) |&gt;\n  flextable()\n\n\nparameterminmaxtheta50.0001,000.0lambda0.0105.0alpha0.000200.0delta0.00020.0tau2.00030.0omega0.0010.5y010.0001,000.0\n\n\n\n\nCode\ndata_rec &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(Treatment == \"Logging\" & trec &gt; 3) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort)) |&gt;\n  mutate(plotnum = as.numeric(as.factor(paste(Site, plot_new))))\ndata_old &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(Treatment == \"Control\" | trec &lt; 0) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort))\n\n\n\n\nCode\nind_rec &lt;- data_rec |&gt;\n  select(Site, Plot, sitenum, plotnum) |&gt;\n  unique() |&gt;\n  arrange(plotnum)\n\nmdata_all &lt;- list(\n  n_equ = nrow(data_old),\n  n_log = nrow(data_rec),\n  s = max(data_old$sitenum),\n  p_log = max(data_rec$plotnum),\n  y_equ = data_old$stocks,\n  in_equ = data_old$prod,\n  out_equ = data_old$mort,\n  y_log = data_rec$stocks,\n  in_log = data_rec$prod,\n  out_log = data_rec$mort,\n  time = data_rec$trec,\n  site_equ = data_old$sitenum,\n  site_log = data_rec$sitenum,\n  plot_log = data_rec$plotnum,\n  site_plot = ind_rec$sitenum,\n  theta_bounds = c(bounds$theta_min, bounds$theta_max),\n  lambda_bounds = c(bounds$lambda_min, bounds$lambda_max),\n  alpha_bounds = c(bounds$alpha_min, bounds$alpha_max),\n  delta_bounds = c(bounds$delta_min, bounds$delta_max),\n  tau_bounds = c(bounds$tau_min, bounds$tau_max),\n  omega_bounds = c(bounds$omega_min, bounds$omega_max),\n  y0_bounds = c(bounds$y0_min, bounds$y0_max)\n)\nsample_model(\"flux_all\", mdata_all)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_all &lt;- as_cmdstan_fit(\n  list.files(\"chains/flux_all/\", full.names = TRUE)\n)\nfit_flux_all\n\n\n variable    mean  median     sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     6932.06 6911.00 116.91 90.30 6774.74 7184.77 1.25       12       41\n mu_y0      88.92   88.92   3.81  3.91   82.50   95.22 1.03       91      195\n sigma_y0   19.64   19.63   0.54  0.54   18.74   20.50 1.02      158      492\n y0_p[1]   111.83  111.77  13.38 13.05   90.87  134.98 1.02      300      480\n y0_p[2]    88.15   87.75  13.59 14.01   66.13  110.43 1.01      449      326\n y0_p[3]    76.80   77.14  13.40 13.10   54.90   99.77 1.03      132       81\n y0_p[4]    96.75   96.75  13.26 13.64   75.06  118.78 1.03      133      148\n y0_p[5]    90.59   90.09  12.83 12.28   69.11  111.06 1.02      488     1563\n y0_p[6]    92.56   93.41  12.97 13.10   70.62  112.69 1.01      477     1801\n y0_p[7]    58.61   59.14   6.96  6.41   46.87   69.78 1.01      586     1584\n\n # showing 10 of 7128 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_all$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\nThe main parameter values are consistent with our expectations.\n\n\nCode\nc(\"lambda_s\", \"tau_s\", \"theta_s\", \"omega_s\") |&gt;\n  fit_flux_all$summary() |&gt;\n  separate(variable, c(\"variable\", NA, \"sitenum\")) |&gt;\n  mutate(sitenum = as.numeric(sitenum)) |&gt;\n  left_join(unique(data_old[, c(\"sitenum\", \"Site\")])) |&gt;\n  select(variable, Site, mean, median, q5, q95, rhat)\n\n\n# A tibble: 32 × 7\n   variable Site           mean median    q5   q95  rhat\n   &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1 lambda   Corinto       1.23   1.23  1.07  1.39   1.02\n 2 lambda   Lesong        4.39   4.47  3.60  4.94   1.01\n 3 lambda   Mbaiki        1.29   1.29  1.17  1.39   1.15\n 4 lambda   Paracou       1.29   1.30  1.17  1.40   1.13\n 5 lambda   SUAS          0.757  0.761 0.682 0.820  1.13\n 6 lambda   Sungai Lalang 4.64   4.70  4.08  4.99   1.02\n 7 lambda   Tapajos Km67  1.68   1.69  1.53  1.84   1.11\n 8 lambda   Ulu Muda      4.31   4.34  3.53  4.93   1.04\n 9 tau      Corinto       4.80   4.79  3.80  5.85   1.02\n10 tau      Lesong        7.53   7.52  6.91  8.16   1.01\n# ℹ 22 more rows\n\n\nThe goodness of fit is satisfactory.\n\n\nCode\npred_data &lt;- data_rec |&gt;\n  select(-plotnum) |&gt;\n  mutate(\n    stocks = fit_flux_all$summary(c(\"mu_y_log\"), median)$median,\n    prod = fit_flux_all$summary(c(\"mu_in_log\"), median)$median,\n    mort = fit_flux_all$summary(c(\"mu_out_log\"), median)$median,\n    val = \"pred\",\n    type = \"rec\"\n  ) |&gt;\n  rbind(mutate(\n    data_old,\n    stocks =\n      fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum],\n    prod = fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum] *\n      fit_flux_all$summary(c(\"omega_s\"), median)$median[data_old$sitenum], # nolint\n    mort = fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum] *\n      fit_flux_all$summary(c(\"omega_s\"), median)$median[data_old$sitenum], # nolint\n    val = \"pred\",\n    type = \"equ\"\n  ))\n\nobs_data &lt;- data_rec |&gt;\n  mutate(\n    val = \"obs\",\n    type = \"rec\"\n  ) |&gt;\n  select(-plotnum) |&gt;\n  rbind(mutate(\n    data_old,\n    val = \"obs\",\n    type = \"equ\"\n  ))\n\npov_data &lt;- rbind(pred_data, obs_data) |&gt;\n  pivot_longer(cols = c(stocks, prod, mort), names_to = \"variable\") |&gt;\n  pivot_wider(names_from = val, values_from = value)\n\ndf_rmse &lt;- pov_data |&gt;\n  group_by(variable) |&gt;\n  summarise(rmse = sqrt(mean((pred - obs)^2)))\n\nlabs &lt;- c(stocks = \"BA stocks\", prod = \"BA productivity\", mort = \"BA mortality\")\n\npov_data |&gt;\n  ggplot(aes(pred, obs)) +\n  geom_point(alpha = 0.25, aes(col = type)) +\n  geom_abline(col = \"red\", linetype = \"dashed\") +\n  geom_text(\n    data = df_rmse,\n    aes(\n      x = -Inf, y = Inf, hjust = -0.1, vjust = 1,\n      label = paste(\"RMSE =\", round(rmse, 2))\n    )\n  ) +\n  theme_bw() +\n  xlab(\"Predicted\") +\n  ylab(\"Observed\") +\n  facet_wrap(~variable, scales = \"free\", labeller = labeller(variable = labs))\n\n\n\n\n\nPredicted vs observed values.\n\n\n\n\nThe equilibrium AGB estimated in the logged plots is consistent overall with the control plots, except in the Malaysian sites (Lesong, Sungai Lalang and Ulu Muda), where it is significantly lower.\n\n\nCode\nind_rec &lt;- data_rec |&gt;\n  select(Site, Plot, sitenum, plotnum) |&gt;\n  unique() |&gt;\n  arrange(plotnum)\ndata.frame(\n  site = levels(as.factor(data_old$Site))[ind_rec$sitenum],\n  theta_rec = fit_flux_all$summary(c(\"theta_log\"), median)$median,\n  theta_equ =\n    fit_flux_all$summary(c(\"theta_s\"), median)$median[ind_rec$sitenum]\n) |&gt;\n  ggplot(aes(theta_equ, theta_rec, col = site)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, lty = 2) +\n  labs(x = \"Equilibrium AGB - controls\", y = \"Equilibrium AGB - logged\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nVisualising the trajectories\nThe predicted flux and stocks trajectories look consistent with the data.\n\n\nCode\npov_data |&gt;\n  subset(variable == \"stocks\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB [\" ~ Mg ~ ha^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"prod\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB productivity [\" ~ Mg ~ ha^-1 ~ yr^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"mort\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB mortality [\" ~ Mg ~ ha^-1 ~ yr^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.",
    "crumbs": [
      "Demographic fluxes",
      "Model calibration"
    ]
  },
  {
    "objectID": "22_flux_model.html",
    "href": "22_flux_model.html",
    "title": "Flux model",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\n\n\nHere we define productivity and mortality as:\n\\[ flux(t) = \\omega \\cdot stocks(t) + \\nu \\cdot STP(t)\\] where \\(stocks(t)\\) is the stocks value at time \\(t\\); \\(\\nu\\) is either 0 (control plots) or 1 (logged plots).\nThe short term process (STP) is an intermediary process caused by logging operations, that disappears over time.\nFor productivity, we define it as: \\(STP_P = \\delta \\cdot(\\frac{t}{\\tau}exp(1-\\frac{t}{\\tau}))^2\\)\nFor mortality, we define it as \\(STP_M = \\alpha\\cdot exp(-\\lambda\\cdot t)\\)\nBecause we expect stocks to reach an equilibrium value at \\(t \\rightarrow +\\infty\\), we have:\n\\[lim_{+\\infty}(prod) = lim_{+\\infty}(mort)\\] Therefore, \\(\\omega\\) is the same for productivity and mortality.\nWe therefore have:\n\\[stocks(t) = stocks(0) + \\int_0^t \\left(\\delta \\cdot(\\frac{x}{\\tau}exp(1-\\frac{x}{\\tau}))^2 - \\alpha\\cdot exp(-\\lambda\\cdot x)\\right)dx\\]\nThe integral calculation is done in the Appendix.\nThe resulting stocks are:\n\\[ stocks(t) = stocks(0) + \\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) - \\frac{\\alpha}{\\lambda}(1-exp(-\\lambda\\cdot t))\\] The equilibrium value is\n\\[stocks(\\infty) = stocks(0) + \\frac{e^{2}}{4} (\\delta \\cdot \\tau) - \\frac{\\alpha}{\\lambda}\\]\nThe figure below illustrates the resulting stocks and fluxes with parameters set to:\n\n\\(\\tau = 15 yrs\\)\n\\(\\delta = 4\\)\n\\(\\alpha = 3\\)\n\\(\\lambda = 0.2\\)\n\\(stocks_0 = 100\\)\n\\(\\omega = 0.02\\)\n\n\n\nCode\nagb0 &lt;- 100\ntau &lt;- 15\ndelta &lt;- 4\nalpha &lt;- 3\nlambda &lt;- 0.2\nomega &lt;- 0.02\n\nagbinf &lt;- agb0 + exp(2) / 4 * delta * tau - alpha / lambda\n\nstp &lt;- function(time, delta, tau) {\n  delta * (time / tau * exp(1 - time / tau))^2\n}\nstocks &lt;- function(time, y0, delta, tau, lambda, alpha) {\n  y0 + delta * tau * exp(2) / 4 -\n    delta * exp((1 - time / tau) * 2) *\n      (time^2 / (2 * tau) + time / 2 + tau / 4) -\n    alpha / lambda * (1 - exp(-lambda * time))\n}\n\nfacet_labs &lt;- c(\n  \"agb\" = \"Stocks\",\n  \"prod\" = \"Productivity\",\n  \"mort\" = \"Mortality\"\n)\nann_segment &lt;- data.frame(\n  t = 50, tinf = 100, value = agbinf, name = \"agb\"\n)\n\ndata.frame(t = seq(0, 100, length.out = 200)) |&gt;\n  mutate(\n    prod = stp(t, delta, tau) +\n      omega * stocks(t, agb0, delta, tau, lambda, alpha),\n    mort = alpha * exp(-lambda * t) +\n      omega * stocks(t, agb0, delta, tau, lambda, alpha),\n    agb = stocks(t, agb0, delta, tau, lambda, alpha)\n  ) |&gt;\n  pivot_longer(-t) |&gt;\n  ggplot(aes(t, value)) +\n  geom_segment(data = ann_segment, aes(xend = tinf), lty = 2) +\n  geom_line() +\n  facet_wrap(~name,\n    scales = \"free\", nrow = 3,\n    labeller = labeller(name = facet_labs),\n    strip.position = \"left\"\n  ) +\n  labs(x = \"Recovery time [yr]\", y = NULL) +\n  theme_minimal() +\n  theme(strip.placement = \"outside\")",
    "crumbs": [
      "Demographic fluxes",
      "Flux model"
    ]
  },
  {
    "objectID": "31_cwd_productivity.html",
    "href": "31_cwd_productivity.html",
    "title": "Composition change data",
    "section": "",
    "text": "Formula for the contribution of fluxes\nThe contribution of a given flux (recruitment, growth or mortality) at time \\(t\\) can be written as:\n\\[CF_{F,t} = \\sum_{i\\in F_t}\\frac{ba_{i,t}  (ft_{i} - CWM_{t-1})}{BA_{t}}-\\sum_{i\\in F_t}\\frac{ba_{i,t-1} (ft_{i} - CWM_{t-1})}{BA_{t-1}}\\] where \\(F_t\\) is the set of trees contributing to a given flux between \\(t-1\\) and \\(t\\) (recruitment: trees recruited at \\(t\\); growth: trees that were measured and alive at \\(t\\) and \\(t-1\\); mortality: trees that died between \\(t-1\\) and \\(t\\)).\n\\(ba_{i,t}\\) is the basal area of a tree \\(i\\) at time \\(t\\); \\(ft_{i}\\) is the functional trait value of tree \\(i\\); \\(BA_t\\) is the basal area of the entire community at \\(t\\); \\(CWM_t\\) is the community weighted mean trait value at \\(t\\).\nWe subtract \\(CWM_{t-1}\\) to have negative contributions when the flux decreases the CWM between \\(t-1\\) and \\(t\\); and positive contributions that increase the \\(CWM\\).\nAs written, the contributions are additive:\n\\[CWM_t= CWM_{t-1} + CF_{G,t} + CF_{R,t}+CF_{M,t}\\]",
    "crumbs": [
      "Functional composition changes",
      "Composition change data"
    ]
  },
  {
    "objectID": "31_cwd_productivity.html#data",
    "href": "31_cwd_productivity.html#data",
    "title": "Composition change data",
    "section": "Data",
    "text": "Data\n\n\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"cwmdiff\", variable)) |&gt;\n  separate(variable, c(\"trait\", NA, \"flux\"), sep = \"_\")\n\n\n\nAnnual changes\n\nParacouMbaikiSUAS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCumulative changes\n\nParacouMbaikiSUAS",
    "crumbs": [
      "Functional composition changes",
      "Composition change data"
    ]
  },
  {
    "objectID": "30_cwd_flux.html",
    "href": "30_cwd_flux.html",
    "title": "Functional composition changes",
    "section": "",
    "text": "Selective logging is a widespread disturbance in tropical forests, with well-documented effects on biodiversity and carbon stocks that often recover within decades. However, long-lasting shifts in community functional composition have received less attention. Functional composition plays a critical role in ecosystem functioning and resilience to climate change, making it essential to understand how and why it changes following disturbance. Despite this, little is known about the spatial and temporal variability in these changes. Drawing from forest succession theory, we hypothesize that changes in functional composition are driven by the arrival of pioneer species and the demographic responses of surviving trees, such as altered growth or mortality rates. We model trajectories of functional composition (i.e. community-weighted mean values of wood density, N leaf content, LA and SLA, weighted by basal area) over time to assess the consistency of responses across traits and regions. We also quantify the relative contributions of demographic processes (recruitment, growth, and mortality) to these changes in functional composition.",
    "crumbs": [
      "Functional composition changes"
    ]
  },
  {
    "objectID": "11_general_framework.html#main-analyses",
    "href": "11_general_framework.html#main-analyses",
    "title": "Conceptual framework",
    "section": "Main analyses",
    "text": "Main analyses\nFor the moment, we focus on two main research questions:\n\nHow long does logging affect demographic processes (productivity and mortality)?\nWhat is the contribution of demographic processes on changes in functional composition?",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "24_expl_variables.html",
    "href": "24_expl_variables.html",
    "title": "Explanatory variables",
    "section": "",
    "text": "Effect of environmental variables\nCode\nenviron &lt;- readr::read_tsv(\"data/raw_data/environment.tsv\")\nparams &lt;- read.csv(\"data/derived_data/params_flux_all.csv\")\nCode\nenviron |&gt;\n  group_by(site) |&gt;\n  summarise(pr = mean(pr)) |&gt;\n  inner_join(filter(params, variable == \"omega\"), by = join_by(site == Site)) |&gt;\n  ggplot(aes(pr, median, col = site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(x = \"Mean annual precipitation [ mm ]\", y = \"AGB turnover rate\") +\n  theme_minimal()\nCode\nenviron |&gt;\n  group_by(site) |&gt;\n  summarise(pr = mean(pr)) |&gt;\n  inner_join(filter(params, variable == \"t95_p\"), by = join_by(site == Site)) |&gt;\n  ggplot(aes(pr, median, col = site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(\n    x = \"Mean annual precipitation [ mm ]\",\n    y = \"AGB overproductivity duration [ yr ]\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Explanatory variables"
    ]
  },
  {
    "objectID": "24_expl_variables.html#effect-of-logging-intensity",
    "href": "24_expl_variables.html#effect-of-logging-intensity",
    "title": "Explanatory variables",
    "section": "Effect of logging intensity",
    "text": "Effect of logging intensity\n\n\nCode\nread.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  filter(Site %in% sites$Site & variable == \"ba\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  group_by(Site, plot_new, Treatment) |&gt;\n  summarise(\n    ba_0 = value[Year == min(Year)],\n    ba_min = min(value[Year &gt; Year_of_harvest & Year &lt;= Year_of_harvest + 5])\n  ) |&gt;\n  mutate(intensity = (ba_0 - ba_min) / ba_0) |&gt;\n  inner_join(filter(params, variable == \"int_p\")) |&gt;\n  ggplot(aes(intensity * 100, median, col = Site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(\n    x = \"Logging intensity [% BA loss]\",\n    y = \"AGB total overproductivity [Mg/ha]\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Explanatory variables"
    ]
  },
  {
    "objectID": "31_cwd_productivity.html#cumulative-changes",
    "href": "31_cwd_productivity.html#cumulative-changes",
    "title": "Composition change data",
    "section": "Cumulative changes",
    "text": "Cumulative changes\n\n\nCode\nlabs_flux &lt;- c(\n  all = \"Change in CWM\",\n  rba = \"Contribution of recruitment\",\n  gba = \"Contribution of growth\",\n  mba = \"Contribution of mortality\"\n)\ndata |&gt;\n  filter(Site == \"Paracou\") |&gt;\n  arrange(Site, plot_new, Year) |&gt;\n  group_by(Site, plot_new, trait, flux) |&gt; \n  mutate(value_cum = cumsum(value)) |&gt; \n  ggplot(aes(x = Year, y = value_cum, group = plot_new, col = Treatment)) +\n  geom_line() +\n  geom_point() +\n  facet_grid(trait ~ flux,\n    scales = \"free\",\n    labeller = labeller(flux = labs_flux)\n  ) +\n  labs(y = NULL, x = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nlabs_flux &lt;- c(\n  all = \"Change in CWM\", rba = \"Contribution of recruitment\",\n  gba = \"Contribution of growth\",\n  mba = \"Contribution of mortality\"\n)\ndata |&gt;\n  filter(Site == \"Mbaiki\") |&gt;\n  arrange(Site, plot_new, Year) |&gt;\n  group_by(Site, plot_new, trait, flux) |&gt; \n  mutate(value_cum = cumsum(value)) |&gt; \n  ggplot(aes(x = Year, y = value_cum, group = plot_new, col = Treatment)) +\n  geom_line() +\n  geom_point() +\n  facet_grid(trait ~ flux,\n    scales = \"free\",\n    labeller = labeller(flux = labs_flux)\n  ) +\n  labs(y = NULL, x = NULL) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nlabs_flux &lt;- c(\n  all = \"Change in CWM\", rba = \"Contribution of recruitment\",\n  gba = \"Contribution of growth\",\n  mba = \"Contribution of mortality\"\n)\ndata |&gt;\n  filter(Site == \"SUAS\") |&gt;\n  arrange(Site, plot_new, Year) |&gt;\n  group_by(Site, plot_new, trait, flux) |&gt; \n  mutate(value_cum = cumsum(value)) |&gt; \n  ggplot(aes(x = Year, y = value_cum, group = plot_new, col = Treatment)) +\n  geom_line() +\n  geom_point() +\n  facet_grid(trait ~ flux,\n    scales = \"free\",\n    labeller = labeller(flux = labs_flux)\n  ) +\n  labs(y = NULL, x = NULL) +\n  theme_minimal()",
    "crumbs": [
      "Functional composition changes",
      "Composition change data"
    ]
  },
  {
    "objectID": "33_calibrate_cwd_model.html",
    "href": "33_calibrate_cwd_model.html",
    "title": "Model calibration",
    "section": "",
    "text": "Data\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"cwmdiff\", variable)) |&gt;\n  separate(variable, c(\"trait\", NA, \"flux\"), sep = \"_\")\nFor now, we only calibrate the model with sites that have censuses every one to two years (Paracou, Mbaiki and SUAS).\nCode\ndata &lt;- data |&gt;\n  filter(Site %in% c(\"Paracou\", \"Mbaiki\", \"SUAS\"))",
    "crumbs": [
      "Functional composition changes",
      "Model calibration"
    ]
  },
  {
    "objectID": "33_calibrate_cwd_model.html#model",
    "href": "33_calibrate_cwd_model.html#model",
    "title": "Model calibration",
    "section": "Model",
    "text": "Model\n\n\nCode\ndata_rec &lt;- data |&gt;\n  mutate(trec = Year - Year_of_harvest) |&gt;\n  filter(Treatment == \"Logging\" & trec &gt; 3) |&gt;\n  filter(Site == \"Paracou\" & trait == \"WD\" & flux == \"all\") |&gt;\n  mutate(plotnum = as.numeric(as.factor(paste(Site, plot_new))))\nmdata_cwd &lt;- list(\n  N = nrow(data_rec),\n  K = 2,\n  P = max(data_rec$plotnum),\n  y = data_rec$value,\n  plot = data_rec$plotnum,\n  time = data_rec$trec\n)\nsample_model(\"exp_spline\", mdata_cwd)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_cwd &lt;- as_cmdstan_fit(\n  list.files(\"chains/exp_spline/\", full.names = TRUE)\n)\nfit_flux_cwd\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4293.25 4311.71 55.60 28.55 4194.96 4354.45 2.41        4       30\n sigma         0.00    0.00  0.00  0.00    0.00    0.00 2.32        4       31\n dlogtau[1]    2.06    2.15  0.22  0.08    1.67    2.26 1.98        5       33\n dlogtau[2]    2.57    2.53  0.56  0.62    1.79    3.40 2.42        4       29\n nu[1]         1.25    0.88  0.96  0.54    0.38    2.95 2.10        5       33\n nu[2]         3.34    2.96  0.89  0.42    2.52    4.97 2.15        5       33\n delta[1,1]   -0.01   -0.01  0.00  0.00   -0.01    0.00 1.37        8       28\n delta[2,1]   -0.01   -0.01  0.00  0.00   -0.01   -0.01 1.05       53       67\n delta[3,1]    0.00    0.00  0.00  0.00    0.00    0.00 1.43        8       29\n delta[4,1]    0.00    0.00  0.00  0.00    0.00    0.00 1.37        8       29\n\n # showing 10 of 2135 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_cwd$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\nCode\nc(\"tau\", \"delta\", \"nu\") |&gt;\n  fit_flux_cwd$summary()\n\n\n# A tibble: 76 × 10\n   variable       mean   median      sd     mad       q5      q95  rhat ess_bulk\n   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 tau[1]      7.99     8.59    1.55e+0 7.23e-1  5.33     9.57e+0  1.98     5.52\n 2 tau[2]     23.2     21.7     9.56e+0 8.38e+0 11.4      3.84e+1  2.42     4.90\n 3 delta[1,1] -0.00663 -0.00681 1.23e-3 1.04e-3 -0.00838 -4.21e-3  1.37     8.82\n 4 delta[2,1] -0.00652 -0.00647 9.16e-4 8.48e-4 -0.00814 -5.12e-3  1.05    53.4 \n 5 delta[3,1] -0.00284 -0.00307 1.31e-3 1.09e-3 -0.00463 -1.95e-4  1.43     8.09\n 6 delta[4,1] -0.00194 -0.00215 1.25e-3 1.03e-3 -0.00367  5.18e-4  1.37     8.76\n 7 delta[5,1] -0.00524 -0.00561 1.47e-3 1.11e-3 -0.00707 -2.25e-3  1.50     7.43\n 8 delta[6,1] -0.00236 -0.00235 8.60e-4 7.86e-4 -0.00376 -9.57e-4  1.03   116.  \n 9 delta[7,1] -0.00571 -0.00589 1.22e-3 1.01e-3 -0.00740 -3.30e-3  1.36     9.09\n10 delta[8,1] -0.00446 -0.00462 1.16e-3 9.78e-4 -0.00604 -2.17e-3  1.27    11.1 \n# ℹ 66 more rows\n# ℹ 1 more variable: ess_tail &lt;dbl&gt;\n\n\n\n\nCode\ndata |&gt;\n  mutate(trec = Year - Year_of_harvest) |&gt;\n  filter(Treatment == \"Logging\" & trec &gt; 3) |&gt;\n  filter(Site == \"Paracou\" & trait == \"WD\" & flux == \"all\") |&gt; \n  mutate(med =  fit_flux_cwd$summary(\"mu\")$median) |&gt;\n  mutate(q5 =  fit_flux_cwd$summary(\"mu\")$q5) |&gt;\n  mutate(q95 =  fit_flux_cwd$summary(\"mu\")$q95) |&gt;\n  ggplot(aes(trec, value, col=plot_new)) +\n  geom_point() + \n  geom_line(aes(y=med))",
    "crumbs": [
      "Functional composition changes",
      "Model calibration"
    ]
  },
  {
    "objectID": "25_explo_res.html",
    "href": "25_explo_res.html",
    "title": "Exploration of summary statistics",
    "section": "",
    "text": "Variability of duration of over-mortality\nWe expect over-mortality to be due to the delayed mortality of damaged trees and to gap contagion (due to increased mortality at the edge of the gaps).\nCode\ndata_explo %&gt;% filter(variable == \"t95_m\") %&gt;% \n  arrange(median) %&gt;% \n  ggplot(aes(median, reorder(Site, median), col = continent)) +\n  geom_pointrange(aes(xmin = q5, xmax = q95)) +\n  labs(\n    x = \"Duration of over-mortality (t95, in years)\",\n    y = \"\"\n  ) +\n  theme_minimal()\nWe expect it to occur within the first few years after logging =&gt; confirmed, over-mortality ends after less than 5 years.\nWe expect it to be quite consistent between sites =&gt; not confirmed, the sites have quite different duration of over-mortality. This is not due to the timing of the censuses after logging:\nCode\nread_csv(\"data/derived_data/aggregated_data_v9.csv\") %&gt;% \n  filter(Site %in% site_info$Site & variable == \"ba\")  %&gt;% \n  mutate(plot_new = Plot)  %&gt;% \n  separate(Plot, \"Plot\", \"_\")  %&gt;% \n  left_join(plot_info)  %&gt;% \n  mutate(trec = Year - Year_of_harvest) %&gt;% \n  filter(trec &gt; 0 & trec &lt; 6) %&gt;% \n  group_by(Site) %&gt;% \n  summarise(trec = paste(unique(trec), collapse = \", \"))\n\n\nRows: 478239 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): Site, Plot, variable\ndbl (2): Year, value\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: Expected 1 pieces. Additional pieces discarded in 3004 rows [264, 265, 266,\n267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282,\n283, ...].\n\n\nJoining with `by = join_by(Site, plot_new)`\n\n\n# A tibble: 8 × 2\n  Site          trec         \n  &lt;chr&gt;         &lt;chr&gt;        \n1 Corinto       1, 2, 3, 4, 5\n2 Lesong        1, 2, 3, 4, 5\n3 Mbaiki        1, 2, 3, 4, 5\n4 Paracou       1, 2, 3, 4, 5\n5 SUAS          2, 4         \n6 Sungai Lalang 1, 2, 3, 4, 5\n7 Tapajos Km67  1, 2, 3, 4   \n8 Ulu Muda      1, 2, 3, 4, 5\nThe variability of timing is probably due to post-logging silvicultural treatment, but we cannot test this as the duration of over-mortality is estimated at the site level.",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  },
  {
    "objectID": "25_explo_res.html#variability-of-duration-of-over-productivity",
    "href": "25_explo_res.html#variability-of-duration-of-over-productivity",
    "title": "Exploration of summary statistics",
    "section": "Variability of duration of over-productivity",
    "text": "Variability of duration of over-productivity\nOver-productivity is due to the opening of the canopy cover that increases the growth of trees that are remnants from the logging, and allows the arrival and growth of new early successional individuals.\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_p\") %&gt;% \n  arrange(median) %&gt;% \n  ggplot(aes(median, reorder(Site, median), col = continent)) +\n  geom_pointrange(aes(xmin = q5, xmax = q95)) +\n  labs(\n    x = \"Duration of over-productivity (t95, in years)\",\n    y = \"\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe expect it to last several decades as post-logging canopy closure takes several decades =&gt; confirmed.\nWe expect the variability of the duration of over-productivity to depends on\n\nthe logging intensity =&gt; cannot be tested as this duration is fitted at the site scale\nthe ecology of the pionneer species (life span) =&gt; could that explain the effect of continent that seems to be quite clear, except for Corinto?\nenvironmental variables related to productivity:\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_p\") %&gt;% \n  select(Site, median, q5, q95, plot_new,\n  continent, \n  et, cwd, pr, tmax, vpd, soil, dsl, dsi) %&gt;% \n  pivot_longer(et : dsi, names_to = \"var_clim\", values_to = \"value\") %&gt;% \n  ggplot(aes(x = value, y = median)) + \n  geom_pointrange(aes(ymin = q5, ymax = q95, col = continent)) + \n  geom_smooth(method = \"lm\", se = FALSE, \n  size = 0.5 , col = \"grey\", linetype = \"dashed\") + \n  labs(\n    x = \"\",\n    y = \"Duration of over-productivity (t95, in years)\"\n  ) + \n  facet_wrap(~ var_clim, scales = \"free_x\") + \n  theme_bw() + \n  theme(legend_position = \"bottom\")\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning in plot_theme(plot): The `legend_position` theme element is not defined\nin the element hierarchy.\n\n\n\n\n\n\n\n\n\n\nTO DO: change the names of the facet and try to interpret…\n\n\nTO DO: test soil factors",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  }
]