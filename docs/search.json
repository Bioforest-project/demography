[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "demography",
    "section": "",
    "text": "Introduction\ndemography is a sub-project of the BioForest project. It aims to analyse tree demographic rates (growth, mortality) in selectively logged forests and their relationship with tree biodiversity and composition, as well as abiotic factors (climate, soil, etc.).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "demography",
    "section": "Usage",
    "text": "Usage\nAll demography analyses rely on the quarto documents (files.qmd) that can be run with R and associated environment defined with renv.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#project",
    "href": "index.html#project",
    "title": "demography",
    "section": "Project",
    "text": "Project\ndemography includes:\n\nAnalyse of the data with associated documentation and figures:\n\nReproducible analyses in files.qmd\nResulting pages in docs/\nDocument structure definition in _quarto.yml\n\nData in data/ with:\n\nAll raw data in raw_data/\nAll derived data in derived_sata/\n\nStan Bayesian models in models/\nStan Bayesian models outputs in chains/\nR scripts with functions in r/\nIntermediary files in outputs/\nFigures in figures/\nR environment definition with renv in renv/ and renv/lock\nR files (.Rbuildignore , .Rdata , .Rprofile , .Rhistory, .lintr)\nGit and GitHub files (.gitignore , .github/)\nProject documentation (README.qmd , README.md , NEWS.md, LICENSE )",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#contribution",
    "href": "index.html#contribution",
    "title": "demography",
    "section": "Contribution",
    "text": "Contribution\nYou can contribute to the project by forking the repository on github and cloning the fork to your machine using several options, including GitHub desktop GUI. Further information on contribution are detailed in the online document: https://bioforest-project.github.io/data_preparation/98_contributing.html.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#help",
    "href": "index.html#help",
    "title": "demography",
    "section": "Help",
    "text": "Help\nPlease preferentially create an issue on GitHub for any questions, bugs or help needed regarding demography: https://github.com/Bioforest-project/demography/issues. However, you can contact us by email through people in the core group (see below).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#core-group",
    "href": "index.html#core-group",
    "title": "demography",
    "section": "Core group",
    "text": "Core group\n\nCamille Piponiot (camille.piponiot-laroche@cirad.fr)\nGéraldine Derroire (geraldine.derroire@cirad.fr)\nIrié Casimir Zo-Bi (casimir.zo@inphb.ci)\nDwinda Putri (dwinda.mariska@gmail.com)\nVincy K Wilson (vincykwilson@gmail.com)\n\nThe whole group consist of participants to the Bioforest project.",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "11_general_framework.html",
    "href": "11_general_framework.html",
    "title": "Conceptual framework",
    "section": "",
    "text": "Context and motivation",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#context-and-motivation",
    "href": "11_general_framework.html#context-and-motivation",
    "title": "Conceptual framework",
    "section": "",
    "text": "Selectively logged forests are becoming the majority of tropical forests \\(\\rightarrow\\) Importance of understanding their recovery process;\nDisturbances such as logging have different effects on the demographic rates of species and can therefore change the species composition and biodiversity in the long term;\nDemographic processes can therefore provide insights into forest resilience.",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#research-questions",
    "href": "11_general_framework.html#research-questions",
    "title": "Conceptual framework",
    "section": "Research questions",
    "text": "Research questions\n\nWhat is the contribution of demographic processes (growth, recruitment, mortality) to post-logging changes in biomass, biodiversity and composition?\nWhat is the link between biomass and biodiversity recovery processes?\nHow do abiotic factors shape demographic processes of recovery?",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#general-diagram",
    "href": "11_general_framework.html#general-diagram",
    "title": "Conceptual framework",
    "section": "General diagram",
    "text": "General diagram\n\n\nCode\ngrViz(\"\ndigraph {\n\n  rankdir=LR\n\n  graph [overlap = true, fontsize = 10]\n\n  subgraph cluster_ba{\n    label='Basal area'; fontsize = 14;\n    node [shape = box, fillcolor='coral', style=filled, fontsize=12]\n    ba_stock [label='Stock']\n    ba_in [label='Gain']\n    ba_out [label='Loss']\n  }\n\n  node [shape = box, fillcolor='coral', style=filled]\n  {rank=same\n  cwm [label='Functional\\ncomposition']\n  div [label='Functional\\ndiversity']\n  }\n  node [fillcolor='powderblue']\n  env [label='Environmental\\nvariables']\n  intensity [label='Logging\\nintensity']\n\n  node [shape = ellipse, fillcolor='whitesmoke']\n  {rank=same\n  closure[label='Canopy\\nclosure']\n  vmax[label='Equilibrium\\nturnover\\nrate']\n  }\n\n  intensity -&gt; closure\n  closure -&gt; {ba_in cwm}\n  vmax -&gt; {ba_out ba_in}\n  env -&gt; {cwm div vmax}\n  cwm -&gt; {ba_in ba_out div}\n  ba_stock -&gt; closure\n\n  edge [style = bold]\n  div -&gt; ba_in\n\n  edge [style = dashed]\n  ba_in -&gt; ba_stock\n  ba_out -&gt; ba_stock\n}\n\")",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "11_general_framework.html#main-analyses",
    "href": "11_general_framework.html#main-analyses",
    "title": "Conceptual framework",
    "section": "Main analyses",
    "text": "Main analyses\nFor the moment, we focus on two main research questions:\n\nHow long does logging affect demographic processes (productivity and mortality)?\nWhat is the contribution of demographic processes on changes in functional composition?",
    "crumbs": [
      "Conceptual framework"
    ]
  },
  {
    "objectID": "20_flux_model.html",
    "href": "20_flux_model.html",
    "title": "Demographic fluxes",
    "section": "",
    "text": "Selective logging is a widespread disturbance in tropical forests, often altering forest structure and reducing aboveground biomass (AGB). While many forests recover over time, the mechanisms driving this recovery remain incompletely understood. At the core of forest regeneration are demographic processes—namely, the growth of surviving trees, recruitment of new individuals, and mortality. These processes govern changes in stem abundance and biomass accumulation, yet few studies have explicitly quantified their individual contributions to AGB recovery following logging.\nHere we examine how demographic processes influence the trajectory of AGB and stem abundance recovery in post-logging tropical forests. Our aim is to identify the processes that most strongly influence recovery and how long it takes for productivity and mortality to recover to the level of unlogged forests.",
    "crumbs": [
      "Demographic fluxes"
    ]
  },
  {
    "objectID": "21_flux_data.html",
    "href": "21_flux_data.html",
    "title": "Flux data",
    "section": "",
    "text": "Choice of variables\nBelow we show the productivity in four sites that have been remeasured for multiple decades.\nCode\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\")\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\")\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable %in% c(\"agb_growth\", \"agb_recr\")) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  pivot_wider(names_from = \"variable\") |&gt;\n  ggplot(aes(Year, agb_recr + agb_growth, ,\n    group = plot_new,\n    col = Treatment\n  )) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"AGB productivity [Mg/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"nstem_recr\") |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"Stem recruitment [/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"agb_mort\") |&gt;\n  filter(Treatment == \"Control\" | Year &gt;= Year_of_harvest + 3) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"AGB mortality [Mg/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()\nCode\ndata |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  subset(variable == \"nstem_mort\") |&gt;\n  filter(Treatment == \"Control\" | Year &gt;= Year_of_harvest + 3) |&gt;\n  subset(Site %in% c(\"Mbaiki\", \"Paracou\", \"Ulu Muda\", \"Lesong\")) |&gt;\n  ggplot(aes(Year, value, group = plot_new, col = Treatment)) +\n  geom_point() +\n  geom_line() +\n  labs(y = \"Stem mortality [/ha/yr]\", col = NULL) +\n  facet_wrap(~Site, scales = \"free\") +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Flux data"
    ]
  },
  {
    "objectID": "21_flux_data.html#site-selection",
    "href": "21_flux_data.html#site-selection",
    "title": "Flux data",
    "section": "Site selection",
    "text": "Site selection\nIn this analysis, we only kept sites that meet the following criteria:\n\nat least 4 post-logging measurements\nat least 10 years of post-logging measurements\npresence of control plots\nproductivity values &lt; 10% (too high)?\n\n\n\nCode\ncriteria_site &lt;- data |&gt;\n  inner_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  group_by(Site) |&gt;\n  summarise(\n    controls = length(unique(plot_new[Treatment == \"Control\"])),\n    logged = length(unique(plot_new[Treatment == \"Logging\"]))\n  )\ndata |&gt;\n  inner_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(Treatment == \"Logging\" & !is.na(Year)) |&gt;\n  group_by(Site, plot_new) |&gt;\n  summarise(\n    ncensus = length(unique(Year[Year &gt; Year_of_harvest])),\n    tcensus = max(Year, na.rm = TRUE) - unique(Year_of_harvest)\n  ) |&gt;\n  group_by(Site) |&gt;\n  summarise(ncensus = median(ncensus), tcensus = median(tcensus)) |&gt;\n  left_join(criteria_site) |&gt;\n  filter(ncensus &gt; 3, tcensus &gt; 9, controls &gt; 0, logged &gt; 0) |&gt;\n  write.csv(\"data/derived_data/sites_to_keep.csv\", row.names = FALSE)\n\n\n\n\nCode\nread.csv(\"data/derived_data/sites_to_keep.csv\") |&gt;\n  arrange(-ncensus) |&gt;\n  kable()\n\n\n\n\n\nSite\nncensus\ntcensus\ncontrols\nlogged\n\n\n\n\nMbaiki\n30\n36.0\n12\n28\n\n\nParacou\n22\n35.0\n24\n36\n\n\nLesong\n12\n30.0\n4\n8\n\n\nSUAS\n12\n24.0\n4\n16\n\n\nUlu Muda\n12\n25.0\n3\n6\n\n\nSungai Lalang\n11\n27.0\n3\n6\n\n\nTapajos Km67\n11\n36.0\n18\n48\n\n\nCorinto\n10\n29.0\n3\n6\n\n\nBAFOG\n9\n74.0\n8\n12\n\n\nJenaro Herrera\n8\n28.0\n2\n7\n\n\nJari\n7\n26.0\n4\n36\n\n\nMisiones\n7\n19.5\n4\n14\n\n\nKibale\n6\n52.0\n11\n15\n\n\nSTREK\n6\n33.0\n12\n36\n\n\nKabo\n4\n33.0\n3\n9",
    "crumbs": [
      "Demographic fluxes",
      "Flux data"
    ]
  },
  {
    "objectID": "22_flux_model.html",
    "href": "22_flux_model.html",
    "title": "Flux model",
    "section": "",
    "text": "Integrating flux values over the census interval\nHere we define productivity and mortality as:\n\\[ flux(t) = \\omega \\cdot stocks(t) + \\nu \\cdot STP(t)\\] where \\(stocks(t)\\) is the stocks value at time \\(t\\); \\(\\nu\\) is either 0 (control plots) or 1 (logged plots).\nThe short term process (STP) is an intermediary process caused by logging operations, that disappears over time.\nFor productivity, we define it as: \\(STP_P = \\delta \\cdot(\\frac{t}{\\tau}exp(1-\\frac{t}{\\tau}))^2\\)\nFor mortality, we define it as \\(STP_M = \\alpha\\cdot exp(-\\lambda\\cdot t)\\)\nBecause we expect stocks to reach an equilibrium value at \\(t \\rightarrow +\\infty\\), we have:\n\\[lim_{+\\infty}(prod) = lim_{+\\infty}(mort)\\] Therefore, \\(\\omega\\) is the same for productivity and mortality.\nWe therefore have:\n\\[stocks(t) = stocks(0) + \\int_0^t \\left(\\delta \\cdot(\\frac{x}{\\tau}exp(1-\\frac{x}{\\tau}))^2 - \\alpha\\cdot exp(-\\lambda\\cdot x)\\right)dx\\]\nThe integral calculation is done in the Appendix.\nThe resulting stocks are:\n\\[ stocks(t) = stocks(0) + \\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) - \\frac{\\alpha}{\\lambda}(1-exp(-\\lambda\\cdot t))\\] The equilibrium value is\n\\[stocks(\\infty) = stocks(0) + \\frac{e^{2}}{4} (\\delta \\cdot \\tau) - \\frac{\\alpha}{\\lambda}\\]\nThe figure below illustrates the resulting stocks and fluxes with parameters set to:\nWhen measuring productivity and mortality, we not measuring their instanteneous value but rather their value integrated over the census interval (typically 1-2 years).\nWe thus integrate the productivity and mortality equations as follows:\n\\[\nProd(t, k)\n= \\omega \\int_{t-k}^t stocks(x)dx + \\int_{t-k}^t STP_P \\\\\n= \\omega \\left( k\\!\\left(S_0 + \\frac{\\delta e^2 \\tau}{4} - \\frac{\\alpha}{\\lambda}\\right)\n+ \\frac{\\alpha}{\\lambda^2}\\,e^{-\\lambda t}\\!\\left(e^{\\lambda k}-1\\right) + \\\\ \\frac{\\delta}{8}\n\\!\\left[\ne^{2\\!\\left(1-\\frac{t-k}{\\tau}\\right)}\\!\\left(2(t-k)^2 + 4(t-k)\\tau + 3\\tau^2\\right)\n- e^{2\\!\\left(1-\\frac{t}{\\tau}\\right)}\\!\\left(2t^2 + 4t\\tau + 3\\tau^2\\right)\n\\right]  \\right) + \\\\\n\\frac{\\delta}{8}\n\\Bigg[\ne^{2\\!\\left(1 - \\frac{t - k}{\\tau}\\right)}\\!\n\\left(2(t - k)^{2} + 4(t - k)\\tau + 3\\tau^{2}\\right)\n- e^{2\\!\\left(1 - \\frac{t}{\\tau}\\right)}\\!\n\\left(2t^{2} + 4t\\tau + 3\\tau^{2}\\right)\n\\Bigg]\n\\]",
    "crumbs": [
      "Demographic fluxes",
      "Flux model"
    ]
  },
  {
    "objectID": "23_calibrate_flux_model.html",
    "href": "23_calibrate_flux_model.html",
    "title": "Model calibration",
    "section": "",
    "text": "Data\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\n\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"^agb\", variable)) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  mutate(prod = agb_growth + agb_recr, mort = agb_mort, stocks = agb) |&gt;\n  select(!contains(\"agb\")) |&gt;\n  group_by(Site, plot_new) |&gt;\n  arrange(Year) |&gt;\n  mutate(tdiff = c(0, diff(Year))) |&gt;\n  ungroup() |&gt;\n  pivot_longer(cols = c(\"stocks\", \"prod\", \"mort\"), names_to = \"variable\") |&gt;\n  mutate(Year_of_harvest = ifelse(Site == \"Mbaiki\" & Treatment == \"Logging\",\n    1985, Year_of_harvest\n  )) |&gt;\n  mutate(trec = Year - Year_of_harvest)\nFor now, we only calibrate the model with sites that meet all the criteria listed here, and that have at least 10 censuses.\nCode\nsites &lt;- read.csv(\"data/derived_data/sites_to_keep.csv\") |&gt;\n  filter(ncensus &gt;= 10)\ndata &lt;- data |&gt;\n  filter(Site %in% sites$Site)",
    "crumbs": [
      "Demographic fluxes",
      "Model calibration"
    ]
  },
  {
    "objectID": "23_calibrate_flux_model.html#model",
    "href": "23_calibrate_flux_model.html#model",
    "title": "Model calibration",
    "section": "Model",
    "text": "Model\nWe used the following parameter bounds when calibrating the model.\n\n\nCode\nbounds &lt;- data.frame(\n  \"theta_min\" = 50,\n  \"theta_max\" = 1000,\n  \"lambda_min\" = 1e-2,\n  \"lambda_max\" = 5,\n  \"alpha_min\" = 0,\n  \"alpha_max\" = 200,\n  \"delta_min\" = 0,\n  \"delta_max\" = 20,\n  \"tau_min\" = 2,\n  \"tau_max\" = 30,\n  \"omega_min\" = 1e-3,\n  \"omega_max\" = 0.5,\n  \"y0_min\" = 10,\n  \"y0_max\" = 1000\n)\nbounds |&gt;\n  pivot_longer(everything(), names_to = \"parameter\") |&gt;\n  separate(parameter, c(\"parameter\", \"bound\")) |&gt;\n  pivot_wider(names_from = bound) |&gt;\n  flextable()\n\n\nparameterminmaxtheta50.0001,000.0lambda0.0105.0alpha0.000200.0delta0.00020.0tau2.00030.0omega0.0010.5y010.0001,000.0\n\n\n\n\nCode\ndata_rec &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(Treatment == \"Logging\" & trec &gt;= 0) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort)) |&gt;\n  mutate(plotnum = as.numeric(as.factor(paste(Site, plot_new))))\ndata_old &lt;- data |&gt;\n  mutate(sitenum = as.numeric(as.factor(Site))) |&gt;\n  subset(Treatment == \"Control\" | trec &lt; 0) |&gt;\n  pivot_wider(names_from = \"variable\", values_from = \"value\") |&gt;\n  subset(!is.na(prod) & !is.na(mort))\n\n\n\n\nCode\nind_rec &lt;- data_rec |&gt;\n  select(Site, Plot, sitenum, plotnum) |&gt;\n  unique() |&gt;\n  arrange(plotnum)\n\nmdata_all &lt;- list(\n  n_equ = nrow(data_old),\n  n_log = nrow(data_rec),\n  s = max(data_old$sitenum),\n  p_log = max(data_rec$plotnum),\n  y_equ = data_old$stocks,\n  in_equ = data_old$prod,\n  out_equ = data_old$mort,\n  y_log = data_rec$stocks,\n  in_log = data_rec$prod,\n  out_log = data_rec$mort,\n  time_stocks = data_rec$trec,\n  time_flux = data_rec$trec - data_rec$tdiff / 2,\n  site_equ = data_old$sitenum,\n  site_log = data_rec$sitenum,\n  plot_log = data_rec$plotnum,\n  site_plot = ind_rec$sitenum,\n  theta_bounds = c(bounds$theta_min, bounds$theta_max),\n  lambda_bounds = c(bounds$lambda_min, bounds$lambda_max),\n  alpha_bounds = c(bounds$alpha_min, bounds$alpha_max),\n  delta_bounds = c(bounds$delta_min, bounds$delta_max),\n  tau_bounds = c(bounds$tau_min, bounds$tau_max),\n  omega_bounds = c(bounds$omega_min, bounds$omega_max),\n  y0_bounds = c(bounds$y0_min, bounds$y0_max)\n)\nsample_model(\"flux_all\", mdata_all)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_all &lt;- as_cmdstan_fit(\n  list.files(\"chains/flux_all/\", full.names = TRUE)\n)\nfit_flux_all\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     6243.58 6243.78 19.66 19.69 6210.36 6274.80 1.00      989     1690\n mu_y0     284.05  284.07  3.40  3.24  278.37  289.62 1.00      887     1474\n sigma_y0   24.89   24.91  0.66  0.67   23.78   25.95 1.00     2042     2986\n y0_p[1]   325.76  325.54 13.74 13.74  303.78  348.50 1.00     6454     3505\n y0_p[2]   289.51  289.06 14.19 14.73  266.92  313.64 1.00     4872     2793\n y0_p[3]   277.38  277.25 13.63 13.51  255.10  300.15 1.00     6332     2678\n y0_p[4]   276.80  276.41 12.99 12.75  256.12  298.53 1.00     5952     2989\n y0_p[5]   297.53  297.36 14.07 14.18  275.02  321.41 1.00     7451     2641\n y0_p[6]   277.19  277.10 13.08 13.21  256.44  299.16 1.00     4823     2793\n y0_p[7]   184.77  184.62 16.10 16.25  158.95  211.22 1.00     3097     2476\n\n # showing 10 of 8379 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_all$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\nThe main parameter values are consistent with our expectations.\n\n\nCode\nc(\"lambda_s\", \"tau_s\", \"theta_s\", \"omega_s\") |&gt;\n  fit_flux_all$summary() |&gt;\n  separate(variable, c(\"variable\", NA, \"sitenum\")) |&gt;\n  mutate(sitenum = as.numeric(sitenum)) |&gt;\n  left_join(unique(data_old[, c(\"sitenum\", \"Site\")])) |&gt;\n  select(variable, Site, mean, median, q5, q95, rhat)\n\n\n# A tibble: 32 × 7\n   variable Site           mean median    q5   q95  rhat\n   &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1 lambda   Corinto       0.682  0.670 0.423 0.980 1.00 \n 2 lambda   Lesong        0.574  0.572 0.495 0.662 1.00 \n 3 lambda   Mbaiki        0.907  0.904 0.789 1.04  1.00 \n 4 lambda   Paracou       0.394  0.393 0.361 0.429 1.00 \n 5 lambda   SUAS          1.91   1.88  1.44  2.46  1.000\n 6 lambda   Sungai Lalang 0.594  0.590 0.506 0.694 1.00 \n 7 lambda   Tapajos Km67  0.685  0.682 0.601 0.777 1.00 \n 8 lambda   Ulu Muda      0.570  0.567 0.483 0.668 1.00 \n 9 tau      Corinto       6.11   6.07  5.24  7.11  1.00 \n10 tau      Lesong        5.79   5.78  5.32  6.27  1.00 \n# ℹ 22 more rows\n\n\nThe goodness of fit is satisfactory.\n\n\nCode\npred_data &lt;- data_rec |&gt;\n  select(-plotnum) |&gt;\n  mutate(\n    stocks = fit_flux_all$summary(c(\"mu_y_log\"), median)$median,\n    prod = fit_flux_all$summary(c(\"mu_in_log\"), median)$median,\n    mort = fit_flux_all$summary(c(\"mu_out_log\"), median)$median,\n    val = \"pred\",\n    type = \"rec\"\n  ) |&gt;\n  rbind(mutate(\n    data_old,\n    stocks =\n      fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum],\n    prod = fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum] *\n      fit_flux_all$summary(c(\"omega_s\"), median)$median[data_old$sitenum], # nolint\n    mort = fit_flux_all$summary(c(\"theta_s\"), median)$median[data_old$sitenum] *\n      fit_flux_all$summary(c(\"omega_s\"), median)$median[data_old$sitenum], # nolint\n    val = \"pred\",\n    type = \"equ\"\n  ))\n\nobs_data &lt;- data_rec |&gt;\n  mutate(\n    val = \"obs\",\n    type = \"rec\"\n  ) |&gt;\n  select(-plotnum) |&gt;\n  rbind(mutate(\n    data_old,\n    val = \"obs\",\n    type = \"equ\"\n  ))\n\npov_data &lt;- rbind(pred_data, obs_data) |&gt;\n  pivot_longer(cols = c(stocks, prod, mort), names_to = \"variable\") |&gt;\n  pivot_wider(names_from = val, values_from = value)\n\ndf_rmse &lt;- pov_data |&gt;\n  group_by(variable) |&gt;\n  summarise(rmse = sqrt(mean((pred - obs)^2)))\n\nlabs &lt;- c(stocks = \"BA stocks\", prod = \"BA productivity\", mort = \"BA mortality\")\n\npov_data |&gt;\n  ggplot(aes(pred, obs)) +\n  geom_point(alpha = 0.25, aes(col = Site, shape = type)) +\n  geom_abline(col = \"red\", linetype = \"dashed\") +\n  geom_text(\n    data = df_rmse,\n    aes(\n      x = -Inf, y = Inf, hjust = -0.1, vjust = 1,\n      label = paste(\"RMSE =\", round(rmse, 2))\n    )\n  ) +\n  theme_bw() +\n  xlab(\"Predicted\") +\n  ylab(\"Observed\") +\n  facet_wrap(~variable, scales = \"free\", labeller = labeller(variable = labs))\n\n\n\n\n\nPredicted vs observed values.\n\n\n\n\nThe equilibrium AGB estimated in the logged plots is consistent overall with the control plots, except in the Malaysian sites (Lesong, Sungai Lalang and Ulu Muda), where it is significantly lower.\n\n\nCode\nind_rec &lt;- data_rec |&gt;\n  select(Site, Plot, sitenum, plotnum) |&gt;\n  unique() |&gt;\n  arrange(plotnum)\ndata.frame(\n  site = levels(as.factor(data_old$Site))[ind_rec$sitenum],\n  theta_rec = fit_flux_all$summary(c(\"theta_log\"), median)$median,\n  theta_equ =\n    fit_flux_all$summary(c(\"theta_s\"), median)$median[ind_rec$sitenum]\n) |&gt;\n  ggplot(aes(theta_equ, theta_rec, col = site)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, lty = 2) +\n  labs(x = \"Equilibrium AGB - controls\", y = \"Equilibrium AGB - logged\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\nVisualising the trajectories\nThe predicted flux and stocks trajectories look consistent with the data.\n\n\nCode\npov_data |&gt;\n  subset(variable == \"stocks\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB [\" ~ Mg ~ ha^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"prod\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB productivity [\" ~ Mg ~ ha^-1 ~ yr^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\nCode\npov_data |&gt;\n  subset(variable == \"mort\") |&gt;\n  mutate(Plot = plot_new) |&gt;\n  graph_traj(expression(\"AGB mortality [\" ~ Mg ~ ha^-1 ~ yr^-1 ~ \"]\"))\n\n\n\n\n\nPredicted trajectories.",
    "crumbs": [
      "Demographic fluxes",
      "Model calibration"
    ]
  },
  {
    "objectID": "24_expl_variables.html",
    "href": "24_expl_variables.html",
    "title": "Explanatory variables",
    "section": "",
    "text": "Effect of environmental variables\nWe chose the following summary statistics:\nCode\nenviron &lt;- readr::read_tsv(\"data/raw_data/environment.tsv\")\nparams &lt;- read.csv(\"data/derived_data/params_flux_all.csv\")\nCode\nenviron |&gt;\n  group_by(site) |&gt;\n  summarise(pr = mean(pr)) |&gt;\n  inner_join(filter(params, variable == \"omega\"), by = join_by(site == Site)) |&gt;\n  ggplot(aes(pr, median, col = site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(x = \"Mean annual precipitation [ mm ]\", y = \"AGB turnover rate\") +\n  theme_minimal()\nCode\nenviron |&gt;\n  group_by(site) |&gt;\n  summarise(pr = mean(pr)) |&gt;\n  inner_join(filter(params, variable == \"t95_p\"), by = join_by(site == Site)) |&gt;\n  ggplot(aes(pr, median, col = site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(\n    x = \"Mean annual precipitation [ mm ]\",\n    y = \"AGB overproductivity duration [ yr ]\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Explanatory variables"
    ]
  },
  {
    "objectID": "24_expl_variables.html#effect-of-logging-intensity",
    "href": "24_expl_variables.html#effect-of-logging-intensity",
    "title": "Explanatory variables",
    "section": "Effect of logging intensity",
    "text": "Effect of logging intensity\n\n\nCode\nread.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  filter(Site %in% sites$Site & variable == \"ba\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  group_by(Site, plot_new, Treatment) |&gt;\n  summarise(\n    ba_0 = value[Year == min(Year)],\n    ba_min = min(value[Year &gt; Year_of_harvest & Year &lt;= Year_of_harvest + 5])\n  ) |&gt;\n  mutate(intensity = (ba_0 - ba_min) / ba_0) |&gt;\n  inner_join(filter(params, variable == \"int_p\")) |&gt;\n  ggplot(aes(intensity * 100, median, col = Site)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95)) +\n  labs(\n    x = \"Logging intensity [% BA loss]\",\n    y = \"AGB total overproductivity [Mg/ha]\"\n  ) +\n  theme_minimal()",
    "crumbs": [
      "Demographic fluxes",
      "Explanatory variables"
    ]
  },
  {
    "objectID": "25_explo_res.html",
    "href": "25_explo_res.html",
    "title": "Exploration of summary statistics",
    "section": "",
    "text": "Duration of over-mortality\nWe expect over-mortality to be due to the delayed mortality of damaged trees and to gap contagion (due to increased mortality at the edge of the gaps).\nWe expect it to occur within the first few years after logging =&gt; confirmed, over-mortality ends after less than 5 years.\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_m\") %&gt;%\n  ggplot(aes(median, reorder(Site, median), col = continent)) +\n  geom_pointrange(aes(xmin = q5, xmax = q95)) +\n  labs(\n    x = \"Duration of over-mortality (t95, in years)\",\n    y = \"\"\n  ) +\n  theme_minimal()\nWe expect it to be quite consistent between sites =&gt; not confirmed, the sites have quite different duration of over-mortality. This is not due to the timing of the censuses after logging (trec):\nCode\nread_csv(\"data/derived_data/aggregated_data_v9.csv\") %&gt;%\n  filter(Site %in% site_info$Site & variable == \"ba\") %&gt;%\n  mutate(plot_new = Plot) %&gt;%\n  separate(Plot, \"Plot\", \"_\") %&gt;%\n  left_join(plot_info) %&gt;%\n  mutate(trec = Year - Year_of_harvest) %&gt;%\n  filter(trec &gt; 0 & trec &lt; 6) %&gt;%\n  group_by(Site) %&gt;%\n  summarise(trec = paste(unique(trec), collapse = \", \")) %&gt;%\n  kable()\n\n\n\n\n\nSite\ntrec\n\n\n\n\nCorinto\n1, 2, 3, 4, 5\n\n\nLesong\n1, 2, 3, 4, 5\n\n\nMbaiki\n1, 2, 3, 4, 5\n\n\nParacou\n1, 2, 3, 4, 5\n\n\nSUAS\n2, 4\n\n\nSungai Lalang\n1, 2, 3, 4, 5\n\n\nTapajos Km67\n1, 2, 3, 4\n\n\nUlu Muda\n1, 2, 3, 4, 5\nThe variability of timing is probably due to post-logging silvicultural treatment, but we cannot test this as the duration of over-mortality is estimated at the site level.",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  },
  {
    "objectID": "25_explo_res.html#duration-of-over-productivity",
    "href": "25_explo_res.html#duration-of-over-productivity",
    "title": "Exploration of summary statistics",
    "section": "Duration of over-productivity",
    "text": "Duration of over-productivity\nOver-productivity is due to the opening of the canopy cover that increases the growth of trees that are remnants from the logging, and allows the arrival and growth of new early successional individuals.\nWe expect it to last several decades as post-logging canopy closure takes several decades =&gt; confirmed.\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_p\") %&gt;%\n  ggplot(aes(median, reorder(Site, median), col = continent)) +\n  geom_pointrange(aes(xmin = q5, xmax = q95)) +\n  labs(\n    x = \"Duration of over-productivity (t95, in years)\",\n    y = \"\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe expect the variability of the duration of over-productivity to depends on:\n\nthe logging intensity =&gt; cannot be tested as this duration is fitted at the site scale\nthe ecology of the pioneer species (life span) =&gt; could that explain the effect of continent that seems to be quite clear, except for Corinto?\ncimatic variables related to productivity =&gt; we see below that over-productivity has a longer duration in the drier sites (higher climate water deficit, dry season intensity and length, vapour pressure deficit (but this is driven by one outlier site) and lower evapotranspiration and precipitation). The pattern with soil humidity is however counter-intuitive (but soil humidity is very positively correlated with maximum temperature).\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_p\") %&gt;%\n  select(\n    Site, median, q5, q95,\n    continent,\n    et, cwd, pr, tmax, vpd, soil, dsl, dsi\n  ) %&gt;%\n  pivot_longer(et:dsi, names_to = \"var_clim\", values_to = \"value\") %&gt;%\n  mutate(var_clim = fct_recode(var_clim,\n    \"Evapotranspiration, mm\" = \"et\",\n    \"Climate water deficit, mm\" = \"cwd\",\n    \"Precipitation, mm\" = \"pr\",\n    \"Maximum temperature, °C\" = \"tmax\",\n    \"Vapour Pressure Deficit, kPa\" = \"vpd\",\n    \"Soil humidity, mm\" = \"soil\",\n    \"Dry season length, days\" = \"dsl\",\n    \"Dry season intensity, mm\" = \"dsi\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95, col = continent)) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"Duration of over-productivity (t95, in years)\"\n  ) +\n  facet_wrap(~var_clim, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nsoil variables related to productivity =&gt; we see below that higher bulk density and lower SOC soils are related to longer duration of over-productivity, which would support the hypotheses that over-productivity lasts longer in less fertile soils. But the pattern obtained for clay content shows the opposite.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"t95_p\") %&gt;%\n  select(\n    Site, median, q5, q95,\n    continent,\n    bdod, cec, cfvo, clay, sand, silt, nitrogen, phh2o, soc, ocd\n  ) %&gt;%\n  pivot_longer(bdod:ocd, names_to = \"var_soil\", values_to = \"value\") %&gt;%\n  mutate(var_soil = fct_recode(var_soil,\n    \"Bulk density, kg dm³\" = \"bdod\",\n    \"CEC, cmolC kg-1\" = \"cec\",\n    \"Fraction of coarse fragments, cm3 100cm-3\" = \"cfvo\",\n    \"Proportion of clay particles, %\" = \"clay\",\n    \"Proportion of sand particles, %\" = \"sand\",\n    \"Proportion of silt particles, %\" = \"silt\",\n    \"Total nitrogen, g kg-1\" = \"nitrogen\",\n    \"Soil pH\" = \"phh2o\",\n    \"Soil organic carbon, g kg-1\" = \"soc\",\n    \"Organic carbon density, kg dm³\" = \"ocd\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median)) +\n  geom_pointrange(aes(ymin = q5, ymax = q95, col = continent)) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"Duration of over-productivity (t95, in years)\"\n  ) +\n  facet_wrap(~var_soil, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nforest dynamism (turnover rate) =&gt; we see below that more dynamic sites (higher turnover rate \\(\\omega\\)) have a lower duration of over-productivity.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable %in% c(\"omega\", \"t95_p\")) %&gt;%\n  select(Site, variable, median, q5, q95, continent) %&gt;%\n  pivot_wider(\n    names_from = variable,\n    values_from = c(median, q5, q95)\n  ) %&gt;%\n  ggplot(aes(x = median_omega, y = median_t95_p)) +\n  geom_errorbar(aes(\n    ymin = q5_t95_p, ymax = q95_t95_p,\n    col = continent,\n    width = 0\n  )) +\n  geom_errorbarh(aes(\n    xmin = q5_omega, xmax = q95_omega,\n    col = continent,\n    height = 0\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Turnover rate (omega)\",\n    y = \"Duration of over-productivity (t95, in years)\"\n  ) +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nThe trends observed seems to generally support the hypothesis that over-productivity would lask longuer is less productive (drier and less fertile) and less dynamic sites (lower turnover rate), which would make sense. Let’s be careful not to over interpret it though, as there are just 8 sites and possible confunding effects due to the correlation among environmental factors in the data set.",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  },
  {
    "objectID": "25_explo_res.html#relative-over-mortality",
    "href": "25_explo_res.html#relative-over-mortality",
    "title": "Exploration of summary statistics",
    "section": "Relative over-mortality",
    "text": "Relative over-mortality\nWe consider relative over-mortality, being the AGB of total over-mortality expressed as a percentage of pre-logging AGB. For this, we need pre-logging censuses, which are not available for the site of Lesong, Sungai Lalang, Tapajos and Ulu Muda. This analyis is therefore limited to 4 sites for the time being.\n\nWe could consider another way to standardise over-mortality, for exemple by using the stock estimated at infinite time by the model (but we first need to check how well it matches pre-logging AGB), or by considering the AGB of control plots (but we first need to check how much intrasite variability the is).\n\nThe graph below show that there is a lot of variability in the relative AGB over-mortality, with values going from less than 30% to almost 80%.\n\n80% is very high, to check…\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_m\" & !(is.na(agb_0))) %&gt;%\n  mutate(site_plot = paste(Site, plot_new)) %&gt;%\n  ggplot(aes(median * 100 / agb_0,\n    reorder(site_plot, median * 100 / agb_0),\n    col = Site,\n    shape = continent\n  )) +\n  geom_pointrange(aes(\n    xmin = q5 * 100 / agb_0,\n    xmax = q95 * 100 / agb_0\n  )) +\n  labs(\n    x = \"AGB over-mortality [% prelogging AGB]\",\n    y = \"\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe expect that this variability would be partly explained by logging intensity, with a higher over-mortality when logging intensity is higher =&gt; this is not confirmed, as the graph below shows the opposite. There seems to be a strong site effect, but the within site trends seems to show that relative-overmortality decreases with logging intensity as well.\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_m\" & !(is.na(agb_0))) %&gt;%\n  mutate(Site = fct_drop(as.factor(Site))) %&gt;%\n  ggplot(aes(\n    x = intensity * 100,\n    y = median * 100 / agb_0\n  )) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Logging intensity [% BA loss]\",\n    y = \"AGB over-mortality [% prelogging AGB]\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nI have no real hypothesis on the effect of environmental variables on the relative over-mortality, but I make some graph anyway, in case some people have. NB: the environmental variables are available at the site level, so with 4 sites, I don’t think we will be able to say much.\n\nClimate variables: the graphs below suggest that relative over-mortality is lower in drier sites.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_m\" & !(is.na(agb_0))) %&gt;%\n  select(\n    Site, plot_new, median, q5, q95, agb_0,\n    continent,\n    et, cwd, pr, tmax, vpd, soil, dsl, dsi\n  ) %&gt;%\n  pivot_longer(et:dsi, names_to = \"var_clim\", values_to = \"value\") %&gt;%\n  mutate(var_clim = fct_recode(var_clim,\n    \"Evapotranspiration, mm\" = \"et\",\n    \"Climate water deficit, mm\" = \"cwd\",\n    \"Precipitation, mm\" = \"pr\",\n    \"Maximum temperature, °C\" = \"tmax\",\n    \"Vapour Pressure Deficit, kPa\" = \"vpd\",\n    \"Soil humidity, mm\" = \"soil\",\n    \"Dry season length, days\" = \"dsl\",\n    \"Dry season intensity, mm\" = \"dsi\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median * 100 / agb_0)) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"AGB over-mortality [% prelogging AGB]\"\n  ) +\n  facet_wrap(~var_clim, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nSoil variables: the graphs below suggest that relative over-mortality is lower in less fertile soils.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_m\" & !(is.na(agb_0))) %&gt;%\n  select(\n    Site, median, q5, q95, agb_0,\n    continent,\n    bdod, cec, cfvo, clay, sand, silt, nitrogen, phh2o, soc, ocd\n  ) %&gt;%\n  pivot_longer(bdod:ocd, names_to = \"var_soil\", values_to = \"value\") %&gt;%\n  mutate(var_soil = fct_recode(var_soil,\n    \"Bulk density, kg dm³\" = \"bdod\",\n    \"CEC, cmolC kg-1\" = \"cec\",\n    \"Fraction of coarse fragments, cm3 100cm-3\" = \"cfvo\",\n    \"Proportion of clay particles, %\" = \"clay\",\n    \"Proportion of sand particles, %\" = \"sand\",\n    \"Proportion of silt particles, %\" = \"silt\",\n    \"Total nitrogen, g kg-1\" = \"nitrogen\",\n    \"Soil pH\" = \"phh2o\",\n    \"Soil organic carbon, g kg-1\" = \"soc\",\n    \"Organic carbon density, kg dm³\" = \"ocd\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median * 100 / agb_0)) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"AGB over-mortality [% prelogging AGB]\"\n  ) +\n  facet_wrap(~var_soil, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nForest dynamism (turnover rate \\(\\omega\\)): the graph below shows that over-mortality increases with turnover rate.\n\n\n\nCode\ndt_omega &lt;- data_explo %&gt;%\n  filter(variable == \"omega\") %&gt;%\n  select(Site, median, q5, q95) %&gt;%\n  rename(\n    median_omega = median,\n    q5_omega = q5,\n    q95_omega = q95\n  )\n\ndata_explo %&gt;%\n  filter(variable == \"int_m\" & !(is.na(agb_0))) %&gt;%\n  select(Site, variable, median, q5, q95, agb_0, continent) %&gt;%\n  left_join(dt_omega) %&gt;%\n  ggplot(aes(x = median_omega, y = median * 100 / agb_0)) +\n  geom_errorbar(\n    aes(\n      ymin = q5 * 100 / agb_0,\n      ymax = q95 * 100 / agb_0,\n      col = Site,\n      shape = continent\n    ),\n    width = 0\n  ) +\n  geom_errorbarh(\n    aes(\n      xmin = q5_omega,\n      xmax = q95_omega,\n      col = Site,\n      shape = continent\n    ),\n    height = 0\n  ) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Turnover rate (omega)\",\n    y = \"AGB over-mortality [% prelogging AGB]\"\n  ) +\n  theme_bw() +\n  theme(legend.position = \"bottom\")",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  },
  {
    "objectID": "25_explo_res.html#relative-over-productivity",
    "href": "25_explo_res.html#relative-over-productivity",
    "title": "Exploration of summary statistics",
    "section": "Relative over-productivity",
    "text": "Relative over-productivity\nWe consider relative over-productivity, being the AGB of total over-productivity expressed as a percentage of pre-logging AGB. For this, we need pre-logging censuses, which are not available for the site of Lesong, Sungai Lalang, Tapajos and Ulu Muda. This analyis is therefore limited to 4 sites for the time being.\n\nWe could consider another way to standardise over-productivity, for exemple by using the stock estimated at infinite time by the model (but we first need to check how well it matches pre-logging AGB), or by considering the AGB of control plots (but we first need to check how much intrasite variability the is).\n\nThe graph below show that there is a lot of variability in the relative AGB over-mortality, with values going from less than 10% to almost 80%*.\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_p\" & !(is.na(agb_0))) %&gt;%\n  mutate(site_plot = paste(Site, plot_new)) %&gt;%\n  ggplot(aes(median * 100 / agb_0,\n    reorder(site_plot, median * 100 / agb_0),\n    col = Site,\n    shape = continent\n  )) +\n  geom_pointrange(aes(\n    xmin = q5 * 100 / agb_0,\n    xmax = q95 * 100 / agb_0\n  )) +\n  labs(\n    x = \"AGB over-productivity [% prelogging AGB]\",\n    y = \"\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe expect that this variability would be partly explained by logging intensity, with a higher over-productivity when logging intensity is higher =&gt; this is confirmed by the graph below (but see the Mbaiki plots).\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_p\" & !(is.na(agb_0))) %&gt;%\n  mutate(Site = fct_drop(as.factor(Site))) %&gt;%\n  ggplot(aes(\n    x = intensity * 100,\n    y = median * 100 / agb_0\n  )) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Logging intensity [% BA loss]\",\n    y = \"AGB over-productivity [% prelogging AGB]\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nI have no real hypothesis on the effect of environmental variables on the relative over-productivity, but I make some graphs anyway, in case some people have. NB: the environmental variables are available at the site level, so with 4 sites, I don’t think we will be able to say much.\n\nClimate variables: the graphs below suggest that relative over-productivity is higher in drier sites.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_p\" & !(is.na(agb_0))) %&gt;%\n  select(\n    Site, plot_new, median, q5, q95, agb_0,\n    continent,\n    et, cwd, pr, tmax, vpd, soil, dsl, dsi\n  ) %&gt;%\n  pivot_longer(et:dsi, names_to = \"var_clim\", values_to = \"value\") %&gt;%\n  mutate(var_clim = fct_recode(var_clim,\n    \"Evapotranspiration, mm\" = \"et\",\n    \"Climate water deficit, mm\" = \"cwd\",\n    \"Precipitation, mm\" = \"pr\",\n    \"Maximum temperature, °C\" = \"tmax\",\n    \"Vapour Pressure Deficit, kPa\" = \"vpd\",\n    \"Soil humidity, mm\" = \"soil\",\n    \"Dry season length, days\" = \"dsl\",\n    \"Dry season intensity, mm\" = \"dsi\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median * 100 / agb_0)) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"AGB over-productivity [% prelogging AGB]\"\n  ) +\n  facet_wrap(~var_clim, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nSoil variables: the graphs below suggest that relative over-productivity is higher in less fertile soils.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_p\" & !(is.na(agb_0))) %&gt;%\n  select(\n    Site, median, q5, q95, agb_0,\n    continent,\n    bdod, cec, cfvo, clay, sand, silt, nitrogen, phh2o, soc, ocd\n  ) %&gt;%\n  pivot_longer(bdod:ocd, names_to = \"var_soil\", values_to = \"value\") %&gt;%\n  mutate(var_soil = fct_recode(var_soil,\n    \"Bulk density, kg dm³\" = \"bdod\",\n    \"CEC, cmolC kg-1\" = \"cec\",\n    \"Fraction of coarse fragments, cm3 100cm-3\" = \"cfvo\",\n    \"Proportion of clay particles, %\" = \"clay\",\n    \"Proportion of sand particles, %\" = \"sand\",\n    \"Proportion of silt particles, %\" = \"silt\",\n    \"Total nitrogen, g kg-1\" = \"nitrogen\",\n    \"Soil pH\" = \"phh2o\",\n    \"Soil organic carbon, g kg-1\" = \"soc\",\n    \"Organic carbon density, kg dm³\" = \"ocd\"\n  )) %&gt;%\n  ggplot(aes(x = value, y = median * 100 / agb_0)) +\n  geom_pointrange(aes(\n    ymin = q5 * 100 / agb_0,\n    ymax = q95 * 100 / agb_0,\n    col = Site,\n    shape = continent\n  )) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"\",\n    y = \"AGB over-productivity [% prelogging AGB]\"\n  ) +\n  facet_wrap(~var_soil, scales = \"free_x\") +\n  theme_bw() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\nForest dynamism (turnover rate \\(\\omega\\)): the graph below shows that over-mortality decreases with turnover rate.\n\n\n\nCode\ndata_explo %&gt;%\n  filter(variable == \"int_p\" & !(is.na(agb_0))) %&gt;%\n  select(Site, variable, median, q5, q95, agb_0, continent) %&gt;%\n  left_join(dt_omega) %&gt;%\n  ggplot(aes(x = median_omega, y = median * 100 / agb_0)) +\n  geom_errorbar(\n    aes(\n      ymin = q5 * 100 / agb_0,\n      ymax = q95 * 100 / agb_0,\n      col = Site,\n      shape = continent\n    ),\n    width = 0\n  ) +\n  geom_errorbarh(\n    aes(\n      xmin = q5_omega,\n      xmax = q95_omega,\n      col = Site,\n      shape = continent\n    ),\n    height = 0\n  ) +\n  geom_smooth(\n    method = \"lm\", se = FALSE,\n    size = 0.5, col = \"grey\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Turnover rate (omega)\",\n    y = \"AGB over-productivity [% prelogging AGB]\"\n  ) +\n  theme_bw() +\n  theme(legend.position = \"bottom\")",
    "crumbs": [
      "Demographic fluxes",
      "Exploration of summary statistics"
    ]
  },
  {
    "objectID": "30_cwd_flux.html",
    "href": "30_cwd_flux.html",
    "title": "Functional composition changes",
    "section": "",
    "text": "Selective logging is a widespread disturbance in tropical forests, with well-documented effects on biodiversity and carbon stocks that often recover within decades. However, long-lasting shifts in community functional composition have received less attention. Functional composition plays a critical role in ecosystem functioning and resilience to climate change, making it essential to understand how and why it changes following disturbance. Despite this, little is known about the spatial and temporal variability in these changes. Drawing from forest succession theory, we hypothesize that changes in functional composition are driven by the arrival of pioneer species and the demographic responses of surviving trees, such as altered growth or mortality rates. We model trajectories of functional composition (i.e. community-weighted mean values of wood density, N leaf content, LA and SLA, weighted by basal area) over time to assess the consistency of responses across traits and regions. We also quantify the relative contributions of demographic processes (recruitment, growth, and mortality) to these changes in functional composition.",
    "crumbs": [
      "Functional composition changes"
    ]
  },
  {
    "objectID": "31_cwd_productivity.html",
    "href": "31_cwd_productivity.html",
    "title": "Composition change data",
    "section": "",
    "text": "Formula for the contribution of fluxes\nThe contribution of a given flux (recruitment, growth or mortality) at time \\(t\\) can be written as:\n\\[CF_{F,t} = \\sum_{i\\in F_t}\\frac{ba_{i,t}  (ft_{i} - CWM_{t-1})}{BA_{t}}-\\sum_{i\\in F_t}\\frac{ba_{i,t-1} (ft_{i} - CWM_{t-1})}{BA_{t-1}}\\] where \\(F_t\\) is the set of trees contributing to a given flux between \\(t-1\\) and \\(t\\) (recruitment: trees recruited at \\(t\\); growth: trees that were measured and alive at \\(t\\) and \\(t-1\\); mortality: trees that died between \\(t-1\\) and \\(t\\)).\n\\(ba_{i,t}\\) is the basal area of a tree \\(i\\) at time \\(t\\); \\(ft_{i}\\) is the functional trait value of tree \\(i\\); \\(BA_t\\) is the basal area of the entire community at \\(t\\); \\(CWM_t\\) is the community weighted mean trait value at \\(t\\).\nWe subtract \\(CWM_{t-1}\\) to have negative contributions when the flux decreases the CWM between \\(t-1\\) and \\(t\\); and positive contributions that increase the \\(CWM\\).\nAs written, the contributions are additive:\n\\[CWM_t= CWM_{t-1} + CF_{G,t} + CF_{R,t}+CF_{M,t}\\]",
    "crumbs": [
      "Functional composition changes",
      "Composition change data"
    ]
  },
  {
    "objectID": "31_cwd_productivity.html#data",
    "href": "31_cwd_productivity.html#data",
    "title": "Composition change data",
    "section": "Data",
    "text": "Data\n\n\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"cwmdiff\", variable)) |&gt;\n  separate(variable, c(\"trait\", NA, \"flux\"), sep = \"_\")\n\n\n\nAnnual changes\n\nParacouMbaikiSUAS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCumulative changes\n\nParacouMbaikiSUAS",
    "crumbs": [
      "Functional composition changes",
      "Composition change data"
    ]
  },
  {
    "objectID": "33_calibrate_cwd_model.html",
    "href": "33_calibrate_cwd_model.html",
    "title": "Model calibration",
    "section": "",
    "text": "Data\nCode\nplot_info &lt;- read.csv(\"data/raw_data/bioforest-plot-information.csv\") |&gt;\n  select(site, plot, Year_of_harvest, Treatment)\ndata &lt;- read.csv(\"data/derived_data/aggregated_data_v9.csv\") |&gt;\n  mutate(plot_new = Plot) |&gt;\n  separate(Plot, \"Plot\", \"_\") |&gt;\n  left_join(plot_info, by = join_by(Site == site, Plot == plot)) |&gt;\n  filter(grepl(\"cwmdiff\", variable)) |&gt;\n  separate(variable, c(\"trait\", NA, \"flux\"), sep = \"_\")\nFor now, we only calibrate the model with sites that have censuses every one to two years (Paracou, Mbaiki and SUAS).\nCode\ndata &lt;- data |&gt;\n  filter(Site %in% c(\"Paracou\", \"Mbaiki\", \"SUAS\"))",
    "crumbs": [
      "Functional composition changes",
      "Model calibration"
    ]
  },
  {
    "objectID": "33_calibrate_cwd_model.html#model",
    "href": "33_calibrate_cwd_model.html#model",
    "title": "Model calibration",
    "section": "Model",
    "text": "Model\n\n\nCode\ndata_rec &lt;- data |&gt;\n  mutate(trec = Year - Year_of_harvest) |&gt;\n  filter(Treatment == \"Logging\" & trec &gt; 3) |&gt;\n  filter(Site == \"Paracou\" & trait == \"WD\" & flux == \"all\") |&gt;\n  mutate(plotnum = as.numeric(as.factor(paste(Site, plot_new))))\nmdata_cwd &lt;- list(\n  N = nrow(data_rec),\n  K = 2,\n  P = max(data_rec$plotnum),\n  y = data_rec$value,\n  plot = data_rec$plotnum,\n  time = data_rec$trec\n)\nsample_model(\"exp_spline\", mdata_cwd)\n\n\nThe resulting Stan fit summary is presented below.\n\n\nCode\nfit_flux_cwd &lt;- as_cmdstan_fit(\n  list.files(\"chains/exp_spline/\", full.names = TRUE)\n)\nfit_flux_cwd\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4293.25 4311.71 55.60 28.55 4194.96 4354.45 2.41        4       30\n sigma         0.00    0.00  0.00  0.00    0.00    0.00 2.32        4       31\n dlogtau[1]    2.06    2.15  0.22  0.08    1.67    2.26 1.98        5       33\n dlogtau[2]    2.57    2.53  0.56  0.62    1.79    3.40 2.42        4       29\n nu[1]         1.25    0.88  0.96  0.54    0.38    2.95 2.10        5       33\n nu[2]         3.34    2.96  0.89  0.42    2.52    4.97 2.15        5       33\n delta[1,1]   -0.01   -0.01  0.00  0.00   -0.01    0.00 1.37        8       28\n delta[2,1]   -0.01   -0.01  0.00  0.00   -0.01   -0.01 1.05       53       67\n delta[3,1]    0.00    0.00  0.00  0.00    0.00    0.00 1.43        8       29\n delta[4,1]    0.00    0.00  0.00  0.00    0.00    0.00 1.37        8       29\n\n # showing 10 of 2135 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nCode\nmcmc_trace(fit_flux_cwd$draws(variables = c(\"lp__\")))\n\n\n\n\n\n\n\n\n\nCode\nc(\"tau\", \"delta\", \"nu\") |&gt;\n  fit_flux_cwd$summary()\n\n\n# A tibble: 76 × 10\n   variable       mean   median      sd     mad       q5      q95  rhat ess_bulk\n   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n 1 tau[1]      7.99     8.59    1.55e+0 7.23e-1  5.33     9.57e+0  1.98     5.52\n 2 tau[2]     23.2     21.7     9.56e+0 8.38e+0 11.4      3.84e+1  2.42     4.90\n 3 delta[1,1] -0.00663 -0.00681 1.23e-3 1.04e-3 -0.00838 -4.21e-3  1.37     8.82\n 4 delta[2,1] -0.00652 -0.00647 9.16e-4 8.48e-4 -0.00814 -5.12e-3  1.05    53.4 \n 5 delta[3,1] -0.00284 -0.00307 1.31e-3 1.09e-3 -0.00463 -1.95e-4  1.43     8.09\n 6 delta[4,1] -0.00194 -0.00215 1.25e-3 1.03e-3 -0.00367  5.18e-4  1.37     8.76\n 7 delta[5,1] -0.00524 -0.00561 1.47e-3 1.11e-3 -0.00707 -2.25e-3  1.50     7.43\n 8 delta[6,1] -0.00236 -0.00235 8.60e-4 7.86e-4 -0.00376 -9.57e-4  1.03   116.  \n 9 delta[7,1] -0.00571 -0.00589 1.22e-3 1.01e-3 -0.00740 -3.30e-3  1.36     9.09\n10 delta[8,1] -0.00446 -0.00462 1.16e-3 9.78e-4 -0.00604 -2.17e-3  1.27    11.1 \n# ℹ 66 more rows\n# ℹ 1 more variable: ess_tail &lt;dbl&gt;\n\n\n\n\nCode\ndata |&gt;\n  mutate(trec = Year - Year_of_harvest) |&gt;\n  filter(Treatment == \"Logging\" & trec &gt; 3) |&gt;\n  filter(Site == \"Paracou\" & trait == \"WD\" & flux == \"all\") |&gt;\n  mutate(med = fit_flux_cwd$summary(\"mu\")$median) |&gt;\n  mutate(q5 = fit_flux_cwd$summary(\"mu\")$q5) |&gt;\n  mutate(q95 = fit_flux_cwd$summary(\"mu\")$q95) |&gt;\n  ggplot(aes(trec, value, col = plot_new)) +\n  geom_point() +\n  geom_line(aes(y = med))",
    "crumbs": [
      "Functional composition changes",
      "Model calibration"
    ]
  },
  {
    "objectID": "91_ipp.html",
    "href": "91_ipp.html",
    "title": "Integration of STP",
    "section": "",
    "text": "\\[\\int STP = \\delta \\cdot e^2 \\int \\left(\\left(\\frac{x}{\\tau}\\right)^2 e^{-\\frac{2}{\\tau}x}\\right) dx \\]\nIPP: we use \\(u' = \\frac{2x}{\\tau^2}\\) and \\(v = -\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}\\)\n\\[\\int STP = \\delta \\cdot e^2 \\left( uv - \\int u'v \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( \\left(\\frac{x}{\\tau}\\right)^2\\cdot(-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) - \\int \\frac{2x}{\\tau^2} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x})dx \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\int \\frac{x}{\\tau} e^{-\\frac{2}{\\tau}x}dx \\right) + C\\]\nAgain, we use an IPP with $u’ = $ and \\(v = -\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}\\)\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\left( uv - \\int u'v \\right) \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}+ \\left( \\frac{x}{\\tau} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) - \\int \\frac{1}{\\tau} (-\\frac{\\tau}{2} \\cdot e^{-\\frac{2}{\\tau}x}) \\right) \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x}  -\\frac{x}{2} \\cdot e^{-\\frac{2}{\\tau}x} + \\int  \\frac{1}{2} \\cdot e^{-\\frac{2}{\\tau}x}  \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^2 \\left( -\\left(\\frac{x^2}{2\\tau}\\right)   e^{-\\frac{2}{\\tau}x} -\\frac{x}{2} \\cdot e^{-\\frac{2}{\\tau}x} -\\frac{\\tau}{4} \\cdot e^{-\\frac{2}{\\tau}x} \\right) + C\\]\n\\[\\int STP = \\delta \\cdot e^{(1-\\frac{x}{\\tau})2} \\left( -\\frac{x^2}{2\\tau}    -\\frac{x}{2}  -\\frac{\\tau}{4}\\right) + C\\]\n\\[\\int_0^t STP = \\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\]\n\\[\\int_0^t LTP = t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\]\n\\[\\int_0^t prod = \\theta_0\\cdot t + (\\theta_{\\infty} - \\theta_0)\\left(t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\right) + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\right) \\]\nif \\(mort = \\theta_{\\infty}\\):\n\\[\\int_0^t mort = \\theta_{\\infty}\\cdot t\\] then:\n\\[BA(t) = BA(0) + \\theta_0\\cdot t + (\\theta_{\\infty} - \\theta_0)\\left(t - \\frac{1}{\\lambda} (1-e^{-\\lambda\\cdot t})\\right) + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right) \\right)  - \\theta_{\\infty}\\cdot t\\]\n\\[BA(t) = BA(0) - \\frac{\\theta_{\\infty} - \\theta_0}{\\lambda}(1-e^{-\\lambda\\cdot t})  + \\theta_{\\infty}\\left(\\frac{\\delta \\cdot e^{2} \\cdot\\tau}{4} - \\delta \\cdot e^{(1-\\frac{t}{\\tau})2} \\left(\\frac{t^2}{2\\tau}+\\frac{t}{2}+\\frac{\\tau}{4}\\right)\\right)  \\]",
    "crumbs": [
      "Appendices",
      "Integration of STP"
    ]
  },
  {
    "objectID": "92_diff_equa.html",
    "href": "92_diff_equa.html",
    "title": "Differential equation",
    "section": "",
    "text": "We want to solve the following differential equation \\(E\\):\n\\[y'(t) = STP(t) - \\alpha\\cdot exp(-\\lambda \\cdot t) + (\\omega_P-\\omega_M) \\cdot y(t)\\]\nwith:\n\\[STP(t) = \\delta\\left(\\frac{t}{\\tau}\\cdot exp(1-\\frac{t}{\\tau})\\right)^2\\]\nThe general solution of differential equation \\(E_0\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = 0\\]\nis \\(y_G = Kexp((\\omega_P-\\omega_M) t)\\)\nA particular solution of differential equation \\(E_1\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = \\alpha\\cdot exp(-\\lambda\\cdot t)\\]\nis\n\\[y_{p1} = -\\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} \\cdot exp(-\\lambda\\cdot t)\\]\nA particular solution of differential equation \\(E_2\\):\n\\[y'(t) - (\\omega_P-\\omega_M) \\cdot y(t) = \\delta \\left(\\frac{t}{\\tau}exp(1-\\frac{t}{\\tau})\\right)^2\\]\nis\n\\[y_{p2} = exp(1-\\frac{t}{\\tau})^2\\frac{2\\delta}{\\tau^2(-2(\\omega_P-\\omega_M)-\\tau)}\\left(t^2 - t\\frac{4}{(-2(\\omega_P-\\omega_M)-\\tau)} + \\frac{8}{(-2(\\omega_P-\\omega_M)-\\tau)^2}\\right)\\]\nThe general solution to differential equation (E) is therefore:\n\\[y(t) = Kexp(-(\\omega_P-\\omega_M) t) -\\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} \\cdot exp(-\\lambda\\cdot t) + exp(1-\\frac{t}{\\tau})^2\\frac{2\\delta}{\\tau^2(-2(\\omega_P-\\omega_M)-\\tau)}\\left(t^2 - t\\frac{4}{(-2(\\omega_P-\\omega_M)-\\tau)} + \\frac{8}{(-2(\\omega_P-\\omega_M)-\\tau)^2}\\right)\\]\n\\[ K = y_0+ \\frac{\\alpha}{(\\omega_P-\\omega_M)+\\lambda} -\\frac{16e^2\\delta}{\\tau^2(2(\\omega_P-\\omega_M)-\\tau)^3}\\]",
    "crumbs": [
      "Appendices",
      "Differential equation"
    ]
  }
]